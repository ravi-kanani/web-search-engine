<!doctype html>
<html lang="en">
 <head>
  <meta name="google-site-verification" content="X5sd8PEDJqYLSR98RKgSozn-0RNpknXFlGoA-UXe5K0">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#d33a2c">
  <meta property="fb:pages" content="45576747489">
  <meta name="flattr:id" content="glyg5e">
  <link rel="icon" type="image/png" href="/images/favicon/favicon.png">
  <link rel="icon" href="/images/favicon/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="/images/favicon/apple-touch-icon-iphone-60x60.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-touch-icon-ipad-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-touch-icon-iphone-retina-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-touch-icon-ipad-retina-152x152.png">
  <link rel="apple-touch-icon" sizes="256x256" href="/images/favicon/app-icon-256x256.png">
  <link rel="apple-touch-icon" sizes="512x512" href="/images/favicon/app-icon-512x512.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="description" content="Chances are pretty good that you’ve worked with, or at least understand the concept of, server compression. By compressing website assets on the server prior to transferring them to the browser, we’ve been able to achieve substantial performance gains.
For quite some time, the venerable gzip algorithm has been the go-to solution for reducing the size of page assets. A new kid on the block has been gaining support in modern browsers, and its name is Brotli. In this article, you’ll get hands-on with Brotli by writing a Node.js-powered HTTP server that implements this new algorithm, and we’ll compare its performance to gzip.">
  <meta name="robots" content="noodp">
  <link rel="canonical" href="https://www.smashingmagazine.com/2016/10/next-generation-server-compression-with-brotli/">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Next Generation Server Compression With Brotli — Smashing Magazine">
  <meta property="og:description" content="Chances are pretty good that you’ve worked with, or at least understand the concept of, server compression. By compressing website assets on the server prior to transferring them to the browser, we’ve been able to achieve substantial performance gains.
For quite some time, the venerable gzip algorithm has been the go-to solution for reducing the size of page assets. A new kid on the block has been gaining support in modern browsers, and its name is Brotli. In this article, you’ll get hands-on with Brotli by writing a Node.js-powered HTTP server that implements this new algorithm, and we’ll compare its performance to gzip.">
  <meta property="og:url" content="https://www.smashingmagazine.com/2016/10/next-generation-server-compression-with-brotli/">
  <meta property="og:site_name" content="Smashing Magazine">
  <meta property="article:publisher" content="https://www.facebook.com/smashmag">
  <meta property="article:author" content="https://www.smashingmagazine.com/author/jeremywagner/">
  <meta property="article:tag" content>
  <meta property="article:section" content="General">
  <meta property="article:published_time" content="2016-10-05 18:58:31 +0000 UTC">
  <meta property="article:modified_time" content="2016-10-05 18:58:31 +0000 UTC">
  <meta property="og:updated_time" content="2016-10-05 18:58:31 +0000 UTC">
  <meta property="og:image" content="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0b13a18-e9c8-4cb8-8940-642911c35d49/brotli-opt.jpeg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="Chances are pretty good that you’ve worked with, or at least understand the concept of, server compression. By compressing website assets on the server prior to transferring them to the browser, we’ve been able to achieve substantial performance gains.
For quite some time, the venerable gzip algorithm has been the go-to solution for reducing the size of page assets. A new kid on the block has been gaining support in modern browsers, and its name is Brotli. In this article, you’ll get hands-on with Brotli by writing a Node.js-powered HTTP server that implements this new algorithm, and we’ll compare its performance to gzip.">
  <meta name="twitter:title" content="Next Generation Server Compression With Brotli — Smashing Magazine">
  <meta name="twitter:site" content="@smashingmag">
  <meta name="twitter:image" content="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/a0b13a18-e9c8-4cb8-8940-642911c35d49/brotli-opt.jpeg">
  <meta property="DC.date.issued" content="2016-10-05 18:58:31 +0000 UTC">
  <link rel="dns-prefetch" href="https://www.gravatar.com/">
  <link rel="dns-prefetch" href="https://cloud.netlifyusercontent.com/">
  <link rel="dns-prefetch" href="https://smashingcomments.netlify.com/">
  <link rel="dns-prefetch" href="https://d33wubrfki0l68.cloudfront.net/">
  <link rel="dns-prefetch" href="https://consent.cookiebot.com/">
  <link rel="dns-prefetch" href="https://consentcdn.cookiebot.com">
  <link rel="dns-prefetch" href="https://www.google-analytics.com/">
  <link rel="dns-prefetch" href="https://res.cloudinary.com/">
  <link rel="dns-prefetch" href="https://cats.smashing.services/">
  <link rel="dns-prefetch" href="https://smashingconf.com/">
  <link rel="dns-prefetch" href="https://smashed.by/">
  <link rel="preconnect" href="https://www.gravatar.com/">
  <link rel="preconnect" href="https://smashingcomments.netlify.com/">
  <link rel="preconnect" href="https://cloud.netlifyusercontent.com/">
  <link rel="preconnect" href="https://d33wubrfki0l68.cloudfront.net/">
  <link rel="preconnect" href="https://consent.cookiebot.com/">
  <link rel="preconnect" href="https://consentcdn.cookiebot.com">
  <link rel="preconnect" href="https://www.google-analytics.com/">
  <link rel="preconnect" href="https://res.cloudinary.com/">
  <link rel="preconnect" href="https://cats.smashing.services/">
  <link rel="preconnect" href="https://smashingconf.com/">
  <link rel="preconnect" href="https://smashed.by/">
  <title>Next Generation Server Compression With Brotli — Smashing Magazine</title>
  <link rel="alternate" type="application/rss+xml" title="Smashing Magazine &amp;raquo; Feed" href="https://www.smashingmagazine.com/feed/">
  <style>@font-face{font-family:ElenaInitial;src:url("https://d33wubrfki0l68.cloudfront.net/a978f759fa0230c1e590d1bdb5a1c03ceb538cec/fed6b/fonts/elenawebregular/elenawebregular.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/9c2752fab289f61c6ed3a1f78ab60fb2034103b7/bf691/fonts/elenawebregular/elenawebregular.woff") format("woff")}@font-face{font-family:Elena;src:url("https://d33wubrfki0l68.cloudfront.net/a978f759fa0230c1e590d1bdb5a1c03ceb538cec/fed6b/fonts/elenawebregular/elenawebregular.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/9c2752fab289f61c6ed3a1f78ab60fb2034103b7/bf691/fonts/elenawebregular/elenawebregular.woff") format("woff")}@font-face{font-family:Elena;src:url("https://d33wubrfki0l68.cloudfront.net/151446eb4ad2f20af89f3132f66d03cc92c856f4/74612/fonts/elenawebregularitalic/elenawebregularitalic.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/a6275674bf99f00da2e019547d61933d074f2ae7/51beb/fonts/elenawebregularitalic/elenawebregularitalic.woff") format("woff");font-style:italic}@font-face{font-family:Elena;src:url("https://d33wubrfki0l68.cloudfront.net/a7cc92a2d6ae8ea43370e14b53d2ce89a2b2b5ab/7cca9/fonts/elenawebbold/elenawebbold.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/c2ebb4866cc6ce6d5ffdb22b616cb3dde4274107/c6bc6/fonts/elenawebbold/elenawebbold.woff") format("woff");font-weight:700}@font-face{font-family:Elena;src:url("https://d33wubrfki0l68.cloudfront.net/bbc71fd1b91cc1a4ede7ea378a8bf30b9e32173e/93eeb/fonts/elenawebbolditalic/elenawebbolditalic.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/56129334a763b7d04f2f34cbbd3b4f68f72bb6d7/8045a/fonts/elenawebbolditalic/elenawebbolditalic.woff") format("woff");font-weight:700;font-style:italic}@font-face{font-family:MijaInitial;src:url("https://d33wubrfki0l68.cloudfront.net/ac1833dce386eb55d8e105248ef9126622e8e3e9/03f2d/fonts/mijaregular/mija_regular-webfont.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/0e0910ceb0e2f9adffd9db31665dafa4ec5c10ff/7214b/fonts/mijaregular/mija_regular-webfont.woff") format("woff")}@font-face{font-family:Mija;src:url("https://d33wubrfki0l68.cloudfront.net/ac1833dce386eb55d8e105248ef9126622e8e3e9/03f2d/fonts/mijaregular/mija_regular-webfont.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/0e0910ceb0e2f9adffd9db31665dafa4ec5c10ff/7214b/fonts/mijaregular/mija_regular-webfont.woff") format("woff")}@font-face{font-family:Mija;src:url("https://d33wubrfki0l68.cloudfront.net/94691bb5497213e09480b17ef68446d2b85667e9/d58ec/fonts/mijabold/mija_bold-webfont.woff2") format("woff2"),url("https://d33wubrfki0l68.cloudfront.net/1d162cc7792bc1f04919a5a344b4082087b9e012/855b4/fonts/mijabold/mija_bold-webfont.woff") format("woff");font-weight:700}</style>
  <script>var fontsInServiceWorker=sessionStorage.foutFontsStage1Loaded&&sessionStorage.foutFontsStage2Loaded||('serviceWorker'in navigator&&navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.state==='activated')
if(!fontsInServiceWorker&&'fonts'in document){function fetchFonts(fonts){return Promise.all(fonts.map(function(font){return document.fonts.load(font);}));}
fetchFonts(['1em ElenaInitial','1em MijaInitial']).then(function(){var docEl=document.documentElement;docEl.classList.add('wf-loaded-stage1');sessionStorage.foutFontsStage1Loaded=true;fetchFonts(['1em Elena','700 1em Elena','italic 1em Elena','italic 700 1em Elena','1em Mija','700 1em Mija']).then(function(){docEl.classList.add('wf-loaded-stage2');sessionStorage.foutFontsStage2Loaded=true;});});}</script>
  <style>@charset "UTF-8";article,header,nav{display:block}strong{font-weight:inherit}strong{font-weight:bolder;letter-spacing:.25px}button,input{font:inherit;margin:0}button{text-transform:none}[type=submit],button{-webkit-appearance:button}[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}.c-garfield-the-cat figcaption a:not(.btn){color:#666;background-image:-webkit-gradient(linear,left top,left bottom,from(#666),to(#666));background-image:linear-gradient(#666,#666)}@media all and (min-width:1100px){@supports(grid-row-gap:0){.c-garfield-the-cat{display:grid;grid-template-columns:11rem repeat(12,minmax(0,1fr)) 15rem;grid-row-gap:calc(1em + .5vw);margin:0 auto}.c-garfield-the-cat>h3{margin-top:calc(1.5 * (1em + .5vw));margin-bottom:0}.c-garfield-the-cat>h4{margin-top:calc(1em + .5vw);margin-bottom:calc(-1 * (1em + .5vw)/2)}.c-garfield-the-cat>*{grid-column-start:3;grid-column-end:13;margin-top:0;margin-bottom:0}.c-garfield-the-cat>table{margin-bottom:calc(1em + .5vw)}.c-garfield-the-cat .c-garfield-bio{grid-column-start:1;grid-column-end:2;grid-row:span 3;align-self:start}.c-garfield-the-cat .c-garfield-header{grid-column-end:15}.c-garfield-the-cat .c-garfield-aside--newsletter{grid-column-start:14;grid-column-end:15;grid-row-start:3;grid-row-end:11;align-self:start}.c-garfield-the-cat .c-garfield-aside--meta{grid-column-start:14;grid-column-end:15;grid-row-start:2;grid-row-end:4;align-self:start;margin:0;overflow:hidden}.c-garfield-the-cat>.break-out{grid-column-start:1;grid-column-end:15;max-width:50em;margin-left:auto;margin-right:auto;width:100%}.c-garfield-the-cat>.break-out img{margin:0 auto}.c-garfield-the-cat>.break-out figcaption{max-width:50em}.article__content .c-garfield-the-cat figcaption{padding-top:calc((1em + .5vw)/2);padding-bottom:0;margin:0 auto}.c-garfield-the-cat>ul li{margin-bottom:calc((1em + .5vw)/2)}.c-garfield-the-cat .c-garfield-native-panel{grid-column-start:1;grid-column-end:2;grid-row-start:4;grid-row-end:10;align-self:start;text-align:center;margin-top:-2em}.c-garfield-the-cat .c-garfield-native-panel__below{grid-row-start:15;grid-row-end:20}.c-garfield-aside--newsletter{display:block}}}strong{letter-spacing:0}figcaption a{color:inherit}.article h1,.article h2,.article h3,.article h4{position:relative}.btn span{color:#811d15;font-size:.8em;margin-left:5px;margin-top:.5em;line-height:1}.btn span.ladda-label{color:inherit;font-size:inherit;margin:0;line-height:inherit}.btn--green{background-color:#41b14f;background-image:-webkit-gradient(linear,left top,left bottom,from(#9ec14c),to(#41b14f));background-image:linear-gradient(#9ec14c,#41b14f);color:#fff}.btn--green span{color:rgba(0,0,0,.5)}.btn.btn--medium{font-size:calc(.9em + .1vw);padding:.75em 1em}.ladda-button{position:relative}.ladda-button .ladda-spinner{position:absolute;z-index:2;display:inline-block;width:32px;height:32px;top:50%;margin-top:0;opacity:0}.ladda-button .ladda-label{position:relative;z-index:3}.ladda-button[data-style=expand-right] .ladda-spinner{right:-6px}.btn span.nl__form__arrow{color:inherit;margin-left:.35em;margin-right:.25em}.article__content figure:not(.bio-image),.article__image{padding:0;margin:1em auto}.article__content figure:not(.bio-image) img,.article__image img{display:block;width:auto;max-width:100%;margin:0 auto;height:auto}.article__content figure:not(.bio-image)>a,.article__image>a{display:block;background:0 0;position:relative;z-index:99}.article__content figure:not(.bio-image) figcaption,.article__image figcaption{color:#666;font-size:calc(.8em + .2vw);font-style:italic;padding:.75em 2em .75em 0;display:table}.article__content figure:not(.bio-image) figcaption a,.article__image figcaption a{color:#666}.article__content figure:not(.bio-image) figcaption::before,.article__image figcaption::before{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNyAxMy4wOSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiNjMmMyYzJ9PC9zdHlsZT48L2RlZnM+PHRpdGxlPmNhbWVyYTwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNOC41IDUuNDRhMi4yMSAyLjIxLjAgMSAwIDIuMjEgMi4yMUEyLjIxIDIuMjEuMCAwIDAgOC41IDUuNDR6TTE0Ljc5IDIuMjFoLTIuNTVhMi4yMSAyLjIxLjAgMCAwLTIuMjQtMi4yMWgtM2EyLjIxIDIuMjEuMCAwIDAtMi4yNCAyLjIxaC0yLjU1YTIuMjEgMi4yMS4wIDAgMC0yLjIxIDIuMjF2Ni40NmEyLjIxIDIuMjEuMCAwIDAgMi4yMSAyLjIxaDEyLjU4YTIuMjEgMi4yMS4wIDAgMCAyLjIxLTIuMjF2LTYuNDZhMi4yMSAyLjIxLjAgMCAwLTIuMjEtMi4yMXptLTYuMjkgOS4zNWEzLjkxIDMuOTEuMCAxIDEgMy45MS0zLjkxIDMuOTEgMy45MS4wIDAgMS0zLjkxIDMuOTF6Ii8+PC9zdmc+);height:1em;width:1.5em;padding-right:.6em;display:table-cell;vertical-align:baseline;position:relative;top:.05em}table{width:100%;border-collapse:collapse;margin-bottom:calc(2em + 2vw);clear:both;font-size:calc(.9em + .05vw)}tr{border-bottom:1px solid #ddd}td{padding:1em 1.5em;border:none;text-align:left}tbody td{text-align:left;color:#000;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 tbody td{font-family:ElenaInitial}.wf-loaded-stage2 tbody td{font-family:Elena}.tablesaw td{line-height:150%;text-align:left;vertical-align:middle}.tablesaw td{vertical-align:middle;font-size:calc(.9em + .05vw)}tbody tr:nth-child(2n) td{background-color:#f7f7f7}.btn--promo-newsletter{display:block;width:100%;text-shadow:1px 1px 1px rgba(0,0,0,.25)}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,header,nav,section{display:block}figcaption,figure,main{display:block}figure{margin:0}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}input{font:inherit;margin:0}[type=submit]{-webkit-appearance:button}[type=submit]::-moz-focus-inner{border-style:none;padding:0}[type=submit]:-moz-focusring{outline:ButtonText dotted 1px}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}.sr-only{display:inline-block;height:0;width:0;line-height:0;overflow:hidden}.hidden{display:none!important}.container{margin-right:auto;margin-left:auto}.row{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:0;margin-left:0}[class*=col-]{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;padding-right:1rem;padding-left:1rem}@media(min-width:48em){.container{width:52rem}}@media(min-width:64em){.container{width:68rem}}@media(min-width:75em){.container{width:79rem}}.row::after{clear:both}.col-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}@media screen and (min-width:48em){.col-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}}.container{width:calc(100% - .5em);max-width:1440px;margin:0 auto;z-index:1;position:relative}.container::after{content:'';display:table;clear:both}@media screen and (min-width:40em){.container{width:92vw}}@media screen and (min-width:48em){.container{width:85vw}}@media screen and (min-width:64em){.container{width:94vw}}.c-garfield-the-cat>p:first-of-type{font-size:1.1em;line-height:1.55em}@media(max-width:1024px){.row{margin-left:0;margin-right:0}.article__content{float:none;margin-top:50px}.article__content::before{display:none}}body,html{min-height:100%;overflow-x:hidden}#main{position:relative;z-index:1;background-color:#fff}.c-garfield-header{clear:both}.c-garfield-the-cat a:not(.btn){color:#006fc6}.c-promo-box{font-size:.9em;border-radius:11px}.c-promo-box a:not(.btn){color:#006fc6}.c-promo-box--ad::before{display:block;white-space:pre-wrap;padding:0 0 1.5em;font-size:.75em;font-style:italic;color:#666}.c-garfield-the-cat .author__desc{font-size:calc(.8em + .15vw);color:#555}.article__summary::before{content:'Quick summary ↬ ';display:inline;font-style:normal;letter-spacing:2px;font-size:.75em;margin:0;font-weight:600;color:var(--THEME_COLOR,#d33a2c);text-transform:uppercase}.c-promo-box--wide::before{margin-top:1em;border-top:8px solid #eee;padding:2em 0 3em;content:'Our friends and supporters. You know, they help us pay the bills ↓';text-align:center}.c-promo-box--wide{padding:0;background:0 0;margin:0 auto}.c-promo-box--ad ul{padding-left:0;margin:0}.bnnr-list{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-align:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-flex-direction:row;flex-direction:row}.sponsors.c-promo-box:not(.c-promo-box--wide) .bnnr-list{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.c-garfield-the-cat{padding:0 1em}.c-garfield-aside--newsletter{display:none}@media all and (min-width:1100px){@supports(grid-row-gap:0){.c-garfield-the-cat{display:grid;grid-template-columns:11rem repeat(12,minmax(0,1fr)) 15rem;grid-row-gap:calc(1em + .5vw);margin:0 auto}.c-garfield-the-cat>h3{margin-top:calc(1.5 * (1em + .5vw));margin-bottom:0}.c-garfield-the-cat>*{grid-column-start:3;grid-column-end:13;margin-top:0;margin-bottom:0}.c-garfield-the-cat .c-garfield-bio{grid-column-start:1;grid-column-end:2;grid-row:span 3;align-self:start}.c-garfield-the-cat .c-garfield-header{grid-column-end:15}.c-garfield-the-cat .c-garfield-aside--newsletter{grid-column-start:14;grid-column-end:15;grid-row-start:3;grid-row-end:11;align-self:start}.c-garfield-the-cat .c-garfield-aside--meta{grid-column-start:14;grid-column-end:15;grid-row-start:2;grid-row-end:4;align-self:start;margin:0;overflow:hidden}.c-garfield-the-cat .c-garfield-native-panel{grid-column-start:1;grid-column-end:2;grid-row-start:4;grid-row-end:10;align-self:start;text-align:center;margin-top:-2em}.c-garfield-aside--newsletter{display:block}}}@media screen and (min-width:80em){.c-garfield-the-cat{display:grid;grid-template-columns:15rem repeat(12,minmax(0,1fr)) 17.5rem}}body{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:#fff}body.articlepage{background-color:#fff}img{max-width:100%}:focus{outline:#811d15 dotted 3px!important}.main-header{padding:1em 0;background:var(--THEME_COLOR,#d33a2c);background:var(--THEME_COLOR,var(--THEME_COLOR,#d33a2c));position:relative;min-height:6.2375rem}@media all and (max-width:901px){.main-header{padding:1em 0 0 .5em}}.header__head{width:100%;padding:0 2em;position:relative;color:#fff}@media(max-width:64em){.header__head{padding:0 1em}}.header__head:after,.header__head:before{content:' ';display:table;clear:both}a.skip-main{left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-999}body{-webkit-font-feature-settings:'onum' 1;font-feature-settings:'onum' 1;color:#333;overflow:hidden;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 body{font-family:ElenaInitial}.wf-loaded-stage2 body{font-family:Elena}body{font-size:1.125em}@media screen and (min-width:48em){body{font-size:calc(.35842vw + .95296em)}}body .form__field__label,body figcaption,body li,body p{line-height:calc(1.5em + .2vw);word-break:break-word}body h1,body h2,body h3{line-height:1.2}body h4{line-height:calc(1.3em + (1.5 - 1.3) * ((100vw - 21em)/(35 - 21)))}@supports(-ms-ime-align:auto){.article__content figure:not(.bio-image) figcaption,.article__image figcaption{display:inline-block}.article__content figure:not(.bio-image) figcaption::before,.article__image figcaption::before{display:inline-block}body{-webkit-font-feature-settings:normal;font-feature-settings:normal}}::-webkit-input-placeholder{color:#666}:-moz-placeholder{color:#666}::-moz-placeholder{color:#666}:-ms-input-placeholder{color:#666}.article-header--meta-item__date,time{font-size:.8em;color:#666;text-transform:lowercase;-webkit-font-feature-settings:'smcp' 1,'c2sc' 1;font-feature-settings:'smcp' 1,'c2sc' 1;letter-spacing:1px;font-variant:small-caps;text-transform:lowercase;background-position:50% 72%;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .article-header--meta-item__date,.wf-loaded-stage1 time{font-family:ElenaInitial}.wf-loaded-stage2 .article-header--meta-item__date,.wf-loaded-stage2 time{font-family:Elena}p{margin:calc(1em + .5vw) 0}figure{margin:0;padding:0}figure:after,figure:before{content:' ';display:table;clear:both}a{text-decoration:none;padding:10px 0;background-image:-webkit-gradient(linear,left top,left bottom,from(currentColor),to(currentColor));background-image:linear-gradient(currentColor,currentColor);background-repeat:no-repeat;background-size:100% 1.5px;background-position:center bottom 29%;background-origin:padding-box;text-shadow:3px 0 #fff,2px 0 #fff,1px 0 #fff,-1px 0 #fff,-2px 0 #fff,-3px 0 #fff;color:#006fc6}@supports(-ms-ime-align:auto){a{text-shadow:none}}h1{font-size:calc(1.625rem + 1.6vw);margin:0;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 h1{font-family:MijaInitial}.wf-loaded-stage2 h1{font-family:Mija}.h2,h2{font-size:calc(1.375rem + 1.6vw);margin:0;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .h2,.wf-loaded-stage1 h2{font-family:MijaInitial}.wf-loaded-stage2 .h2,.wf-loaded-stage2 h2{font-family:Mija}h3{font-size:calc(1.5rem + .25vw);margin:2em 0 .75em;text-transform:capitalize;color:#333;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 h3{font-family:ElenaInitial}.wf-loaded-stage2 h3{font-family:Elena}h4{font-size:calc(1.125rem + .25vw);text-transform:uppercase;letter-spacing:1px;margin-top:2em;margin-bottom:1em;color:#333}@media all and (min-width:1550px){h1{font-size:2.13894em}.h2,h2{font-size:2.14857em}}.article h1,.article h2,.article h3{position:relative}ul{padding:0;margin:1em 0;max-width:100%}ul{list-style:none;padding-left:calc(1.4em + .7vw);list-style-image:url("https://d33wubrfki0l68.cloudfront.net/5242cdc0f8a0d710a02b6dcdd43ef5002bf5ae89/77199/images/bullet.svg")}ul>li{margin-bottom:.5em;padding-left:.25em}ul>li p{margin-top:0}.main-nav__dropdown{position:relative;float:left;width:calc(100% - 18em)}@media all and (max-width:1349px){.main-nav__dropdown{width:calc(100% - 10em)}}@media all and (max-width:900px){.main-nav__dropdown{width:80%}}@media(max-width:48em){.main-nav__dropdown{width:75%}}.main-nav{margin:0;overflow:hidden;text-align:center}.main-nav:after,.main-nav:before{content:' ';display:table;clear:both}.main-nav__list{overflow:hidden;list-style:none;margin:0;padding:0;text-align:center;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}@media(max-width:40em){.main-nav__dropdown{width:100%;float:none;clear:both}.main-nav__list{display:block}}.main-nav__item{padding:0;-webkit-box-flex:9999;-ms-flex:9999;flex:9999}@media screen and (-ms-high-contrast:active),screen and (-ms-high-contrast:none){.main-nav__item{width:18%!important}}@media all and (min-width:850px){.main-nav__item{width:20%}}.main-nav__item a{display:block;padding:0}.enhanced .closed{max-height:0}.enhanced .closed .main-nav__item{opacity:1;-webkit-transform:none;transform:none}@media all and (max-width:901px){.enhanced .closed .main-nav__item{opacity:0}}.enhanced .closed .main-nav__item .main-nav__icon{-webkit-transform:none;transform:none}@media all and (max-width:880px){.enhanced .closed .main-nav__item .main-nav__icon{-webkit-transform:translateY(-.25em);transform:translateY(-.25em)}}.open .main-nav__item{display:inline-block;text-align:center;margin-bottom:-4px;padding:.5em;opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}@media all and (min-width:1600px){.open .main-nav__item{font-size:1.2em}}@media all and (max-width:1100px){.open .main-nav__item{margin:0;text-align:center;padding:.5em}}@media all and (max-width:640px){.open .main-nav__item{width:50%;margin-right:0;float:left;font-size:1.1em}.open .main-nav__item a{display:block;width:100%;height:100%}.open .main-nav__item:nth-of-type(3n+1){background-color:#bc3428}.open .main-nav__item:nth-of-type(3n+2){background-color:#d7372a}.open .main-nav__item:nth-of-type(3n+3){background-color:#c13125}}.open .main-nav__item:last-of-type{width:100%;margin-top:1em;-webkit-font-feature-settings:'smcp' 1,'c2sc' 1;font-feature-settings:'smcp' 1,'c2sc' 1;letter-spacing:1px;font-variant:small-caps;text-transform:lowercase;background-position:50% 72%;display:none}.open .main-nav__item:last-of-type a{background-position:50% 72%;color:#000;display:inline-block;border-bottom:1px solid;padding:0}.open .main-nav__item .main-nav__icon{display:block;margin:0 auto;position:relative;-webkit-transform:translateY(0);transform:translateY(0);width:1.5em;margin-bottom:.25em}.open .main-nav__item .main-nav__icon::before{display:block;content:'';position:absolute;background-image:url(https://d33wubrfki0l68.cloudfront.net/10f9f40f8856e393ab4525a46bd8e60af9580324/0ab7a/images/shadow.png);background-size:100%;background-repeat:no-repeat;right:0;-webkit-transform-origin:30% 50%;transform-origin:30% 50%;top:65%;width:120%;left:-15%;height:10px}.open .main-nav__item .main-nav__icon img{will-change:transform;-webkit-transform-origin:0 100%;transform-origin:0 100%;-webkit-transform:rotate(-11deg);transform:rotate(-11deg)}@media(max-width:40em){.main-nav__item a{padding:.5em 0}.open .main-nav__item .main-nav__icon{display:none!important}}.open .main-nav__item figure{margin:0;padding:0}.open .main-nav__item a{background:0 0;text-shadow:none;color:#fff}.open .main-nav__item.active a{color:#390c09;text-shadow:none}.open .main-nav__item.active h2{text-shadow:none}.open .main-nav__item figcaption h2{font-size:calc(.8em + .6vw);color:inherit;text-shadow:1px 1px 1px rgba(0,0,0,.25);white-space:nowrap}.open .main-nav__item figcaption p{font-style:italic;font-size:calc(.7em + .15vw);max-width:100%;margin:.2em auto;display:none}@media screen and (-ms-high-contrast:active),screen and (-ms-high-contrast:none){.open .main-nav__item figcaption p{font-size:16px!important;letter-spacing:-.5px!important}}@media all and (min-width:1000px){.open .main-nav__item figcaption p{display:block;opacity:0;position:absolute}}@media all and (min-width:901px){.enhanced .slideUp.main-nav{max-height:10em}}.btn{display:inline-block;border-radius:11px;padding:.5em 1em;text-align:center;color:#fff;border:none;font-weight:700;background:0 0;background-color:var(--THEME_COLOR,#d33a2c);background-image:-webkit-gradient(linear,left top,left bottom,from(#f88040),to(#d33a2c));background-image:linear-gradient(to bottom,#f88040,#d33a2c);font-size:.9em;outline:0;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .btn{font-family:MijaInitial}.wf-loaded-stage2 .btn{font-family:Mija}.menu-trigger{background:0 0;text-shadow:none;color:inherit;padding:0;border:3px solid #fff;font-size:calc(.9em + .1vw);font-weight:700;color:#fff;float:right;border-radius:8px;padding:calc(.4em + .2vw) .5em calc(.4em + .2vw) .7em;width:6.25em;position:relative;z-index:1;margin-top:.3em;white-space:nowrap;text-shadow:1px 1px 1px rgba(0,0,0,.25);display:none;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .menu-trigger{font-family:MijaInitial}.wf-loaded-stage2 .menu-trigger{font-family:Mija}@media all and (max-width:900px){.menu-trigger{position:absolute;top:0;right:1em;width:5.5em}}@media all and (min-width:900px){.menu-trigger{margin-top:calc(1.5em + .2vw)}}@media all and (min-width:1101px){.open .main-nav__item{min-height:8.35rem}.open .main-nav__item figcaption p{opacity:1;position:static;white-space:nowrap}.menu-trigger{margin-top:calc(1.5em + .7vw)}}.enhanced .menu-trigger{display:inline-block}@supports(display:flex){.enhanced .menu-trigger{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.enhanced .menu-trigger svg{position:relative;margin-top:-1px;margin-right:10px}}.header__topics{text-align:center;display:none;clear:both;width:100%;margin:0 auto}@media(max-width:48em){.header__topics{width:100%}}.enhanced .closed .header__topics{max-height:0;overflow:hidden;display:block;height:0}.header__topics__title{color:#fff;font-size:.9em;margin:3.5em 0 2.5em}.header__topics__list{padding:0}.header__topics__list:after,.header__topics__list:before{content:' ';display:table;clear:both}.closed .header__topics__list,.closed .header__topics__title{opacity:0;-webkit-transform:translateY(2em);transform:translateY(2em)}.search-topics-dropdown{overflow:hidden;clear:both;max-width:calc(900px + 15vw);margin:0 auto}.header__search{width:100%;margin:calc(.5em + 3vh) 50px 0 0;padding:0 0 calc(.5em + .5vw)}@media(max-width:64em){.header__search{margin-right:5vw}}.header__search input[type=search]{border:none;display:block;width:100%;font-size:calc(1em + .2vw);color:#333;background-color:#fff;padding:.8em 1em;padding-left:2.5em;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgaGVpZ2h0PSIyNCIgd2lkdGg9IjI0Ij48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhci1ncmFkaWVudCIgeDE9IjIyLjMxIiB5MT0iMjMuNjIiIHgyPSIzLjczIiB5Mj0iMy4wNSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2U5MzcyMiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2Y4NmYyNSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjx0aXRsZT5NYWduaWZpZXI8L3RpdGxlPjxwYXRoIGZpbGw9InVybCgjbGluZWFyLWdyYWRpZW50KSIgZD0iTTIzLjMzIDIwLjFsLTQuNzMtNC43NGExMC4wNiAxMC4wNi4wIDEgMC0zLjIzIDMuMjNsNC43NCA0Ljc0YTIuMjkgMi4yOS4wIDEgMCAzLjIyLTMuMjN6bS0xNy40OC01Ljg0YTUuOTQgNS45NC4wIDEgMSA4LjQyLjAgNiA2IDAgMCAxLTguNDIuMHoiLz48L3N2Zz4=);background-repeat:no-repeat;background-size:1em;background-position:.75em;border-radius:11px;outline:0}@media all and (max-width:480px){.header__search{margin-right:0}.header__search input[type=search]{font-size:.7em;padding:.9em 1.2em;padding-left:2.5em;background-position:.8em}}.header__search input[type=search]::-ms-clear{display:none}.header__search input[type=search]::-webkit-input-placeholder{color:#666}.header__search input[type=search]::-moz-placeholder{color:#666}.header__search input[type=search]:-ms-input-placeholder{color:#666}.header__search input[type=submit]{width:0;height:0;padding:0}.enhanced .header__search input[type=submit]{display:none}@media screen and (-webkit-min-device-pixel-ratio:0){.header__search input[type=search]{font-size:calc(1em + .2vw)}}.search-input-wrapper{position:relative}.search-clear-button{background:0 0;border:none;padding:0 .5em 0 .75em;position:absolute;right:13px;top:30%;-webkit-transform:translateY(5px);transform:translateY(5px);opacity:0}.closed .header__search{opacity:0;-webkit-transform:translateY(2em);transform:translateY(2em)}.no-js .closed .header__search{opacity:1;-webkit-transform:none;transform:none}.header__search-logo{margin-top:.8em;clear:both}.header__search-logo img{float:right;height:16px;width:130px}.logo{font-size:1em;float:left;line-height:0;width:3em;position:relative;z-index:1}@media all and (min-width:900px){.logo{margin-top:1em}}@media all and (min-width:1350px){.logo{width:10.5em;margin-top:1.5em}}.logo a{display:block;background:0 0;outline:0;padding:0;color:transparent;text-shadow:none}.logo a picture{display:block}.logo img{height:3.75em}a.back-to-top{display:block;background:0 0;width:50px;height:50px;opacity:.7;text-shadow:none;border-radius:11px;padding:12.5px;-webkit-transform-origin:bottom left;transform-origin:bottom left;will-change:transform;-webkit-transform:rotate(-11deg);transform:rotate(-11deg);background-color:#666}a.back-to-top svg{display:block}.back-to-top-wrapper{width:50px;height:50px;display:none;position:fixed;bottom:1em;right:1em;z-index:9}.back-to-top-wrapper::before{display:block;content:'';height:90%;width:160%;position:absolute;background-image:url(https://d33wubrfki0l68.cloudfront.net/10f9f40f8856e393ab4525a46bd8e60af9580324/0ab7a/images/shadow.png);background-size:100%;background-repeat:no-repeat;top:89%;left:-30%;right:0;-webkit-transform-origin:30% 50%;transform-origin:30% 50%}@media(min-height:600px){.back-to-top-wrapper{display:block}}label{max-width:100%}.form__field{display:block;font-size:.9em;width:100%;margin-bottom:1.5em}.form__field__input,input[type=email]{background:#fff;border:1px solid #bbb;background-position:right 1.35em center;background-size:.25em .25em;background-repeat:no-repeat;margin-bottom:5px;border-radius:11px;padding:1.35em 2em .6em 1em;display:block;width:100%;outline:0;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .form__field__input,.wf-loaded-stage1 input[type=email]{font-family:ElenaInitial}.wf-loaded-stage2 .form__field__input,.wf-loaded-stage2 input[type=email]{font-family:Elena}.form__field__label{display:block;margin-bottom:.5em}input{border-color:#aaa}.enhanced .form__field--floating{position:relative}.enhanced .form__field--floating .form__field__label{position:absolute;top:8px;left:1.25em;color:#aaa;font-size:calc(.8em + .1vw);padding:8px 0;z-index:1}.back-to-top-wrapper{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden}.cookies{background-color:#fff;border-radius:11px;position:fixed;width:calc(10em + 1vw);padding:1em;z-index:99;-webkit-box-shadow:0 6px 40px rgba(0,0,0,.3);box-shadow:0 6px 40px rgba(0,0,0,.3);bottom:1em;left:1em}.cookies p{margin-top:0;font-size:.75em}@media screen and (max-width:420px){.cookies{right:0;left:0;width:100%;border-radius:0;bottom:0}.cookies p{margin-top:1em}}@media screen and (max-width:380px){.cookies p{margin-top:0}}.cookies--image{display:none;margin:0 auto;max-width:100px;float:left;margin-right:1em;margin-bottom:1em}.cookies--btn{width:100%}.cookies--btn:first-of-type{margin-bottom:.5em}.sponsors ul{padding-left:0;text-align:center}.sponsors__lead{position:relative}.sponsors__lead::before{position:absolute;border-bottom:8px solid #eee;left:0;-webkit-transform:translate(0,-100%);transform:translate(0,-100%);top:-12px;content:'Caution: shameless plug ahead! Continue reading below ↓';font-size:.7em;color:#666;padding-bottom:10px;width:100%;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .sponsors__lead::before{font-family:MijaInitial}.wf-loaded-stage2 .sponsors__lead::before{font-family:Mija}.sponsors.sponsors__lead{width:100%;grid-column-start:2;grid-column-end:14;margin:4.5em auto 2em}img{position:relative}img::before{height:2.5em;display:block;top:2em;content:' ';width:100%;z-index:2;left:0}img::after{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMzIgMzIiIHN0eWxlPSJtYXJnaW4tcmlnaHQ6MTBweCI+PHBhdGggZmlsbD0iIzc3NyIgZD0iTTI2IDI4SDZ2LTRsNi0xMCA4LjIxOSAxMEwyNiAyMHY4eiIvPjxwYXRoIGZpbGw9IiM3NzciIGQ9Ik0yNiAxNWMwIDEuNjU3LTEuMzQzIDMtMyAzcy0zLTEuMzQzLTMtMyAxLjM0My0zIDMtM2MxLjY1Ny4wIDMgMS4zNDMgMyAzeiIvPjxwYXRoIGZpbGw9IiM3NzciIGQ9Ik0yOC42ODEgNy4xNTljLS42OTQtLjk0Ny0xLjY2Mi0yLjA1My0yLjcyNC0zLjExNnMtMi4xNjktMi4wMy0zLjExNi0yLjcyNGMtMS42MTItMS4xODItMi4zOTMtMS4zMTktMi44NDEtMS4zMTlINC41Yy0xLjM3OC4wLTIuNSAxLjEyMS0yLjUgMi41djI3QzIgMzAuODc4IDMuMTIyIDMyIDQuNSAzMmgyM2MxLjM3OC4wIDIuNS0xLjEyMiAyLjUtMi41VjEwYzAtLjQ0OC0uMTM3LTEuMjMtMS4zMTktMi44NDF6TTI0LjU0MyA1LjQ1N2MuOTU5Ljk1OSAxLjcxMiAxLjgyNSAyLjI2OCAyLjU0M0gyMlYzLjE4OWMuNzE4LjU1NiAxLjU4NCAxLjMwOSAyLjU0MyAyLjI2OHpNMjggMjkuNWMwIC4yNzEtLjIyOS41LS41LjVoLTIzYy0uMjcxLjAtLjUtLjIyOS0uNS0uNXYtMjdjMC0uMjcxLjIyOS0uNS41LS41LjAuMCAxNS40OTkuMCAxNS41LjB2N2MwIC41NTIuNDQ4IDEgMSAxaDd2MTkuNXoiLz48L3N2Zz4=) " " attr(alt);font-size:.9em;display:block;color:#666;line-height:1.5;position:absolute;font-style:italic;z-index:2;top:calc(2em - 35px);text-align:center;width:104%;left:-2%;padding:2.25em 1em;text-shadow:none;background-color:#eee;border-radius:11px}@media screen and (min-width:40em){.author__desc{margin-left:1em}}.author__desc{font-size:.8em;position:relative;font-style:normal!important;color:#333;padding:0!important;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .author__desc{font-family:ElenaInitial}.wf-loaded-stage2 .author__desc{font-family:Elena}.author__desc p{margin:1em 0}.author__desc__title{color:#666;text-transform:uppercase;letter-spacing:2px;font-size:.9em;margin:0;font-weight:400;font-family:AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .author__desc__title{font-family:ElenaInitial}.wf-loaded-stage2 .author__desc__title{font-family:Elena}@media(max-width:40em){.author__desc{width:100%}}.l-author-bio{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.l-author-bio-image{-ms-flex-preferred-size:178px;flex-basis:178px;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}.l-author-bio-content{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-negative:1;flex-shrink:1;-ms-flex-preferred-size:300px;flex-basis:300px}.feature-panel-container{grid-column-start:1;grid-column-end:15;margin-top:3.5em;margin-bottom:2.5em}@media(min-width:800px){.feature-panel-container{margin-top:5em}}.article{padding-top:calc(.5em + 3vw)}.c-garfield-the-cat .article__summary{position:initial}.article__summary{-ms-flex-item-align:center;align-self:center;font-size:1.15em;margin-top:0}.article__summary{line-height:1.55em;color:#666;font-style:italic;position:relative;padding-bottom:1.5em;border-bottom:3px solid #e5e5e5;margin-bottom:.5em}@media all and (max-width:420px){.article__content{margin-top:0}}.article__content [data-src],[data-src]{display:block;width:100%}.article__content [data-src]:not([data-component]){min-height:350px}.article__content{line-height:1.5;padding:0}.article__content a:not(.btn){color:#006fc6}.drop-caps+p::first-line{font-weight:700;font-variant:all-small-caps;text-transform:lowercase;letter-spacing:.5px;font-size:1.1em}.drop-caps{width:calc(96px + 1vw);height:calc(120px + 4vw);float:left;margin-right:1.5em;position:relative;left:calc(-1.3em - .5vw);top:.5vw}@media all and (min-width:500px){.drop-caps{width:150px;height:186px;min-width:100px;margin-left:0}}@media screen and (min-width:64em){.author__desc{margin-left:0}.drop-caps{display:none}}.drop-caps img{max-width:100%}.drop-caps img:nth-of-type(2){position:absolute;bottom:0;right:-40px;width:75%}@media all and (min-height:500px){body.articlepage{overflow:initial}}::-moz-range-track,::-ms-track{background-color:#3f91e5;width:100%}.form__field__label--extra{display:inline}@media(max-width:64em){a.back-to-top{opacity:.3}.form__field__label--extra{display:none}}.hidden{display:none}.article-header{margin:0 0 .5em}@media all and (max-width:1099px){.sponsors:not(.sponsors__lead):not(.sponsors-leaderboard):not(#sponsors-article-end):not(.sponsors__mobile){display:none}.article-header--title{margin-bottom:1em}}.article-header--meta{display:-webkit-box;display:-ms-flexbox;display:flex;list-style:none;padding:0;margin:0;margin:1em 0;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .article-header--meta{font-family:MijaInitial}.wf-loaded-stage2 .article-header--meta{font-family:Mija}.article-header--meta li{padding:0;margin:0;margin-right:0}.article-header--meta li::before{display:none}.article-header--meta li::after{content:'•';font-size:.8em;color:var(--THEME_COLOR,#d33a2c);display:inline-block;margin:0 .4em}.article-header--meta li:last-of-type::after{display:none}.article-header--date{color:#666;font-size:inherit;font-family:inherit}.article-header--meta-item{font-size:.9em;font-family:inherit;display:-webkit-box;display:-ms-flexbox;display:flex}.article-header--comments{font-size:.9em}.meta-box{background:#f6f6f6;padding:1em;margin:0 0 2em;list-style:none;width:100%;border-radius:11px;font-size:.8em;font-family:Calibri Bold,AvenirNext,Avenir,-apple-system,BlinkMacSystemFont,Roboto Slab,Droid Serif,Segoe UI,Oxygen-Sans,Ubuntu,Cantarell,Georgia,serif}.wf-loaded-stage1 .meta-box{font-family:MijaInitial}.wf-loaded-stage2 .meta-box{font-family:Mija}.meta-box li,.meta-box--item{line-height:1.4;padding-left:calc(1em + .5em);background-size:auto 1em;background-repeat:no-repeat;background-position:0 0;margin-bottom:.5em}.meta-box li:last-child{margin-bottom:0}.meta-box--item:last-child{margin-bottom:0}.meta-box--tags{background-image:url(https://www.smashingmagazine.com/images/icons/tags.svg)}.meta-box--share{background-image:url(//res.cloudinary.com/indysigner/image/upload/v1530815949/bird_j6gn7w.svg)}.meta-box--published{background-image:url(https://www.smashingmagazine.com/images/icons/published.svg)}.article__content .meta-box{margin-bottom:2em}.meta-box a{text-shadow:3px 0 #f6f6f6,2px 0 #f6f6f6,1px 0 #f6f6f6,-1px 0 #f6f6f6,-2px 0 #f6f6f6,-3px 0 #f6f6f6}@media all and (max-width:640px){.enhanced .form__field--floating .form__field__label{font-size:.8em;padding:10px 0}.meta-box{margin-bottom:2em}}.promo-newsletter{position:relative;display:inline-block;background:#f6f6f6;padding:1.25em;margin-top:50%;padding-top:50%;width:100%;border-radius:11px}.promo-newsletter-image-wrapper{position:absolute;left:50%;top:0;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:80%}.promo-newsletter-image-link{position:relative;display:block;width:100%;padding-top:calc(100% * 1.25);background:0 0}.promo-newsletter-image{position:absolute;top:0;left:0;height:100%;width:100%;-o-object-fit:contain;object-fit:contain}.promo-newsletter-title{margin-top:20px;font-size:calc(1.25em + .5vw)}.promo-newsletter--article{grid-column-start:2;grid-column-end:14;margin:calc(((1.25/2) * 200px) - 1.5em) auto}@media screen and (max-width:1099px){.promo-newsletter--article{max-width:30em}}.promo-newsletter-description a{text-shadow:3px 0 #f6f6f6,2px 0 #f6f6f6,1px 0 #f6f6f6,-1px 0 #f6f6f6,-2px 0 #f6f6f6,-3px 0 #f6f6f6}.bio-image{--bio-image-border-color:var(--THEME_COLOR, #d33a2c);--bio-image-border-width:5px}.bio-image,.bio-image *,.bio-image :after,.bio-image :before{-webkit-box-sizing:border-box;box-sizing:border-box}.bio-image{padding:0;margin:0;display:block;position:relative}.bio-image::before{display:block;content:'';height:90%;width:160%;position:absolute;background-image:url(https://d33wubrfki0l68.cloudfront.net/10f9f40f8856e393ab4525a46bd8e60af9580324/0ab7a/images/shadow.png);background-size:100%;background-repeat:no-repeat;top:89%;left:-30%;right:0;-webkit-transform-origin:30% 50%;transform-origin:30% 50%}@media screen and (min-width:40em){.bio-image{display:-webkit-box;display:-ms-flexbox;display:flex}}@media screen and (min-width:64em){.bio-image{--bio-image-border-width:8px;display:block}}.bio-image-wrapper{background:var(--bio-image-background-color,var(--bio-image-border-color,var(--THEME_COLOR,#d33a2c)));border:solid var(--bio-image-border-width,8px) var(--bio-image-border-color,var(--THEME_COLOR,#d33a2c));border-radius:var(--bio-image-border-radius,22px);-webkit-transform:scale(.84) translateX(15%) rotateZ(calc(-1 * (11 * 1deg)));transform:scale(.84) translateX(15%) rotateZ(calc(-1 * (11 * 1deg)));-webkit-transform-origin:0 100%;transform-origin:0 100%;overflow:hidden}.bio-image-image{width:100%;-o-object-fit:cover;object-fit:cover;display:block;-webkit-transform:scale(1.2) rotateZ(calc(11 * 1deg));transform:scale(1.2) rotateZ(calc(11 * 1deg))}a.bio-image-link{background:0 0;text-shadow:none;color:inherit;padding:0;display:block;width:100%}.bio-image-image[data-src]{min-height:0!important;padding-top:100%}.clearfix:after,.clearfix:before{content:' ';display:table;clear:both}*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}.mbl{margin-bottom:20px!important}</style>
  <link id="mainCSS" rel="stylesheet" media="print" href="https://d33wubrfki0l68.cloudfront.net/css/c358fe472782e0c1dfd78bca53271eedfacf038b/css/main.css">
  <script>document.getElementById('mainCSS').media='all';</script>
  <script>if(sessionStorage.foutFontsStage1Loaded&&sessionStorage.foutFontsStage2Loaded||('serviceWorker'in navigator&&navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.state==='activated')){var docEl=document.documentElement;docEl.classList.add('wf-loaded-stage1');docEl.classList.add('wf-loaded-stage2');}
if('serviceWorker'in navigator&&!localStorage.getItem('no_sw')){navigator.serviceWorker.register('/sw.js').then(function(reg){window.sw=reg
window.caches.keys().then(function(cacheNames){cacheName=cacheNames.filter(function(cacheName){return cacheName.indexOf("smashing-mag")!==-1;})[0]
caches.open(cacheName).then(function(cache){return cache.keys().then(function(requests){var urls=requests.filter(function(request){return request.url.match(/[0-9]{4}\/[0-9]{2}\/[^images].*\//);}).slice(0,5).map(function(request){return request.url;});return urls.sort();})}).then(function(cachedArticles){if(cachedArticles.length){var listItem=document.createElement('li')
var innerList=cachedArticles.map(function(url){return '<li><a href="'+url+'">'+url+'</a></li>'}).join('')
listItem.innerHTML="Recently viewed aritcles: <ul>"+innerList+"</ul>"
var list=document.querySelector('.offline-articles-list')
list&&list.appendChild(listItem)}})})}).catch(function(err){console.error('Failed to load service worker')});}
if(!('querySelector')in document&&"addEventListener"in window&&"getComputedStyle"in window){window.document.documentElement.className+=" no-js";}
window.document.documentElement.className+=" enhanced js";window.TablesawConfig={i18n:{swipePreviousColumn:'',swipeNextColumn:''}}</script>
 </head>
 <body class="no-js  articlepage">
  <div data-handler="PreLoad" id="top"></div><a href="#main" class="skip-main">Skip to main content</a> <a href="#article__content" class="skip-main">Start reading the article</a> <a href="/articles" class="skip-main">Jump to list of all articles</a>
  <header class="main-header block" data-handler="MenuButton">
   <div class="container--header">
    <div class="header__head" role="navigation">
     <div class="logo">
      <a href="/" title="← Back to the homepage">
       <picture> 
        <source media="(min-width: 1350px)" srcset="https://d33wubrfki0l68.cloudfront.net/81fa290218cedc39d32be7b1f1aba58a25829ebe/0a05f/images/logo--full.svg">
        <img src="https://d33wubrfki0l68.cloudfront.net/3fbf6ef77e5e00aea7a22423087373169b52ae7e/413ff/images/logo/logo.svg" alt="Smashing Magazine">
       </picture></a>
     </div>
     <div class="menu-button-and-menu">
      <a href="#footer" class="menu-trigger" id="menu-button" aria-controls="main-nav" role="button" aria-expanded="false">
       <svg tabindex="-1" viewbox="0 0 24 24" height=".85em" width=".85em" style="position:relative;margin-right:8px">
        <title>Search</title><path fill="#fff" d="M23.33 20.1l-4.73-4.74a10.06 10.06.0 1 0-3.23 3.23l4.74 4.74a2.29 2.29.0 1 0 3.22-3.23zm-17.48-5.84a5.94 5.94.0 1 1 8.42.0 6 6 0 0 1-8.42.0z" />
       </svg>Topics <script type="text/javascript">var menuButton=document.getElementById('menu-button');function makeLinksUnfocusable(links){links&&Array.from(links).forEach(function(link){link.setAttribute('tabindex','-1');});}
function makeLinksFocusable(links){links&&Array.from(links).forEach(function(link){link.removeAttribute('tabindex');});}
menuButton.addEventListener('click',function(){let expanded=this.getAttribute('aria-expanded')==='true'?true:false;if(expanded){makeLinksUnfocusable();}else{makeLinksFocusable();}
this.setAttribute('aria-expanded',(!expanded).toString());});function menuButtonTextHandler(){var navigation=document.getElementById('main-nav');var navigationLinks=navigation.querySelectorAll('a');if(window.matchMedia("(min-width: 901px)").matches){menuButton.innerHTML='<svg viewBox="0 0 24 24" height=".85em" width=".85em" style="position: relative; margin-right: 8px;"><title>Search</title><path fill="#fff" d="M23.33 20.1l-4.73-4.74a10.06 10.06 0 1 0-3.23 3.23l4.74 4.74a2.29 2.29 0 1 0 3.22-3.23zm-17.48-5.84a5.94 5.94 0 1 1 8.42 0 6 6 0 0 1-8.42 0z"/></svg> Topics';makeLinksFocusable(navigationLinks);}
else{menuButton.innerHTML='<svg viewBox="0 0 24 24" height=".85em" width=".85em" style="position: relative; margin-right: 8px;"><title>Search</title><path fill="#fff" d="M23.33 20.1l-4.73-4.74a10.06 10.06 0 1 0-3.23 3.23l4.74 4.74a2.29 2.29 0 1 0 3.22-3.23zm-17.48-5.84a5.94 5.94 0 1 1 8.42 0 6 6 0 0 1-8.42 0z"/></svg> Menu';makeLinksUnfocusable(navigationLinks);}}
window.addEventListener('DOMContentLoaded',menuButtonTextHandler,false);window.addEventListener('resize',menuButtonTextHandler,false);</script></a>
      <div class="main-nav__dropdown clearfix" id="menu">
       <nav role="presentation" class="main-nav closed slideUp" id="main-nav">
        <ul class="main-nav__list open" id="js-main-nav__list">
         <li class="main-nav__item active"><a href="/articles/">
           <figure role="presentation">
            <span class="main-nav__icon"><img src="https://d33wubrfki0l68.cloudfront.net/2bc30327ebf529a249e825447d86f18546a1d6db/36b19/images/nav-icons/articles.svg" alt width="39" height="44"></span>
            <figcaption role="presentation">
             <h2 class="main-nav__item__title" role="presentation"><span>Articles <span class="sr-only">.</span></span></h2>
             <p>Design &amp; development</p>
            </figcaption>
           </figure></a></li>
         <li class="main-nav__item"><a href="/printed-books/">
           <figure role="presentation">
            <span class="main-nav__icon"><img src="https://d33wubrfki0l68.cloudfront.net/9b4ab044835dfde9adcfb5433a36be21a66cee4c/5b489/images/nav-icons/books.svg" alt width="39" height="44"></span>
            <figcaption role="presentation">
             <h2 class="main-nav__item__title" role="presentation"><span>Books <span class="sr-only">.</span></span></h2>
             <p class="main-nav__figcaption">Physical &amp; digital books</p>
            </figcaption>
           </figure></a></li>
         <li class="main-nav__item"><a href="/events/">
           <figure role="presentation">
            <span class="main-nav__icon"><img src="https://d33wubrfki0l68.cloudfront.net/5831a43ae2230e30a035539e7c2b831561d2d2fd/86bab/images/nav-icons/events.svg" alt width="39" height="44"></span>
            <figcaption role="presentation">
             <h2 class="main-nav__item__title" role="presentation"><span>Events <span class="sr-only">.</span></span></h2>
             <p class="main-nav__item__figcaption">Conferences &amp; workshops</p>
            </figcaption>
           </figure></a></li>
         <li class="main-nav__item"><a href="/jobs">
           <figure role="presentation">
            <span class="main-nav__icon"><img src="https://d33wubrfki0l68.cloudfront.net/0b5647613c9ac6cfb7358e2c12d2912daa78af4f/15c46/images/nav-icons/jobs.svg" alt width="39" height="44"></span>
            <figcaption role="presentation">
             <h2 class="main-nav__item__title" role="presentation"><span>Jobs <span class="sr-only">.</span></span></h2>
             <p class="main-nav__item__figcaption">Find work &amp; employees</p>
            </figcaption>
           </figure></a></li>
         <li class="main-nav__item"><a href="/membership">
           <figure role="presentation">
            <span class="main-nav__icon"><img src="https://d33wubrfki0l68.cloudfront.net/75778fbc97d23f2fca1610f78b2d7226b137fbfc/acdc3/images/nav-icons/membership.svg" alt width="39" height="44"></span>
            <figcaption role="presentation">
             <h2 class="main-nav__item__title" role="presentation"><span>Membership <span class="sr-only">.</span></span></h2>
             <p class="main-nav__item__figcaption">Webinars &amp; early-birds</p>
            </figcaption>
           </figure></a></li>
         <li class="main-nav__item"><a href="#topics" id="js-topics-fallback">Browse All Topics</a></li>
        </ul>
       </nav>
      </div>
     </div>
     <div class="search-topics-dropdown container--header closed" id="header-dropdown">
      <div class="header__search">
       <form data-handler="Search" id="js-search-form" class="search-form" method="get" action="https://www.google.com/webhp?q=site:smashingmagazine.com">
        <label for="js-search-input"></label>
        <div class="search-input-wrapper">
         <input type="search" name="q" id="js-search-input" autocomplete="off" placeholder="Search Smashing..." aria-label="Search Smashing"> 
         <input type="hidden" name="sitesearch" value="smashingmagazine.com"> <a id="js-search-clear-button" class="search-clear-button" tabindex="-1" role="button">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 15.35 15.36" width="16" height="16" tabind="-1">
           <title>Clear Search</title><path fill="#e33b2a" d="M8.38 11.41c-.5-.5-.78-.52-1.33.0l-3.05 3.08c-1.18 1.18-1.7 1.18-3-.16s-1.18-2-.18-3l3.18-3.19a.69.69.0 0 0-.07-1.14l-3-3c-1-1-1.13-1.81.0-3s1.9-1.21 3.13.0l2.94 3a.66.66.0 0 0 1.11.0c.63-.65 2.49-2.51 3.28-3.35a1.46 1.46.0 0 1 2.3-.15c.24.24.47.42.89.84.86.86.94 1.57.05 2.46l-3.27 3.26c-.36.34-.52.58-.16.94l3.27 3.27c1.1 1.1 1.23 1.7.05 2.88l-.58.58a1.59 1.59.0 0 1-2.46-.21z" />
          </svg></a>
        </div>
        <input type="submit" name="submit" value="Search" class="btn" id="js-search-submit">
       </form>
       <div class="header__search-logo">
        <a href="https://www.algolia.com/"><img src="https://d33wubrfki0l68.cloudfront.net/11a5e7690621ea3c342176fe395f8ab04e74b963/24691/images/search-by-algolia-white.svg" alt="Search powered by our good friends at Algolia"></a>
       </div>
      </div>
      <div data-component="SearchResults" data-lite="true"></div>
      <div class="header__topics" id="topics-list">
       <h4 class="header__topics__title">Browse All Topics</h4>
       <ul class="header__topics__list">
        <li class="header__topics__item"><a href="/category/accessibility" tabindex="-1">Accessibility</a></li>
        <li class="header__topics__item"><a href="/category/android" tabindex="-1">Android</a></li>
        <li class="header__topics__item"><a href="/category/animation" tabindex="-1">Animation</a></li>
        <li class="header__topics__item"><a href="/category/apps" tabindex="-1">Apps</a></li>
        <li class="header__topics__item"><a href="/category/css" tabindex="-1">CSS</a></li>
        <li class="header__topics__item"><a href="/category/design" tabindex="-1">Design</a></li>
        <li class="header__topics__item"><a href="/category/design-patterns" tabindex="-1">Design Patterns</a></li>
        <li class="header__topics__item"><a href="/category/design-systems" tabindex="-1">Design Systems</a></li>
        <li class="header__topics__item"><a href="/category/e-commerce" tabindex="-1">E-Commerce</a></li>
        <li class="header__topics__item"><a href="/category/freebies" tabindex="-1">Freebies</a></li>
        <li class="header__topics__item"><a href="/category/graphics" tabindex="-1">Graphics</a></li>
        <li class="header__topics__item"><a href="/category/html" tabindex="-1">HTML</a></li>
        <li class="header__topics__item"><a href="/category/illustrator" tabindex="-1">Illustrator</a></li>
        <li class="header__topics__item"><a href="/category/inspiration" tabindex="-1">Inspiration</a></li>
        <li class="header__topics__item"><a href="/category/ios" tabindex="-1">iOS</a></li>
        <li class="header__topics__item"><a href="/category/javascript" tabindex="-1">JavaScript</a></li>
        <li class="header__topics__item"><a href="/category/mobile" tabindex="-1">Mobile</a></li>
        <li class="header__topics__item"><a href="/category/pattern-libraries" tabindex="-1">Pattern Libraries</a></li>
        <li class="header__topics__item"><a href="/category/performance" tabindex="-1">Performance</a></li>
        <li class="header__topics__item"><a href="/category/photoshop" tabindex="-1">Photoshop</a></li>
        <li class="header__topics__item"><a href="/category/plugins" tabindex="-1">Plugins</a></li>
        <li class="header__topics__item"><a href="/category/react" tabindex="-1">React</a></li>
        <li class="header__topics__item"><a href="/category/responsive-web-design" tabindex="-1">Responsive Web Design</a></li>
        <li class="header__topics__item"><a href="/category/service-workers" tabindex="-1">Service Workers</a></li>
        <li class="header__topics__item"><a href="/category/sketch" tabindex="-1">Sketch</a></li>
        <li class="header__topics__item"><a href="/category/typography" tabindex="-1">Typography</a></li>
        <li class="header__topics__item"><a href="/category/ui" tabindex="-1">UI</a></li>
        <li class="header__topics__item"><a href="/category/usability" tabindex="-1">Usability</a></li>
        <li class="header__topics__item"><a href="/category/user-experience" tabindex="-1">User Experience</a></li>
        <li class="header__topics__item"><a href="/category/wallpapers" tabindex="-1">Wallpapers</a></li>
        <li class="header__topics__item"><a href="/category/web-design" tabindex="-1">Web Design</a></li>
        <li class="header__topics__item"><a href="/category/wordpress" tabindex="-1">WordPress</a></li>
        <li class="header__topics__item"><a href="/category/workflow" tabindex="-1">Workflow</a></li>
       </ul>
      </div>
     </div>
    </div>
   </div>
  </header>
  <main id="main" tabindex="-1">
   <script id="gotell" type="application/json">{"created_at":"2016-10-05T18:58:31Z"}</script>
   <article class="block article" role="main">
    <div class="container article-container">
     <div class="row">
      <div class="col-12 article__content" id="article__content">
       <div class="c-garfield-the-cat">
        <div class="c-garfield-bio">
         <div class="l-author-bio">
          <div class="l-author-bio-image mbl">
           <figure role="presentation" class="bio-image">
            <a href="/author/jeremywagner" class="bio-image-link">
             <div class="bio-image-wrapper">
              <div data-size="400" class="bio-image-image" data-src="https://www.gravatar.com/avatar/1439e90e6361bfbcef96639fed4c6241?s=400&amp;d=mm&amp;r=g" data-alt="Jeremy Wagner"></div>
             </div></a>
           </figure>
          </div>
          <div class="l-author-bio-content author__desc" id="author__desc">
           <h3 class="author__desc__title">About The Author</h3>
           <p>Jeremy Wagner is a performance-obsessed front end developer, author and speaker living and working in the frozen wastes of Saint Paul, Minnesota. He is also the … <a href="/author/jeremywagner" class="show-more-link">More about <span>Jeremy Wagner </span>…</a></p>
          </div>
         </div>
        </div>
        <div class="c-garfield-header">
         <header class="article-header">
          <ul class="article-header--meta">
           <li class="article-header--meta-item article-header--meta-item__date"><time class="article-header--date" datetime="2016-10-05">October 5, 2016</time></li>
           <li class="article-header--meta-item"><span class="article-header--comments"><a href="#comments-next-generation-server-compression-with-brotli"><span data-component="CommentsCount" data-insert="true" data-thread="/2016/10/next-generation-server-compression-with-brotli/" data-article="articles/2016-10-05-next-generation-server-compression-with-brotli.md">Leave a comment</span></a></span></li>
          </ul>
          <h1 class="article-header--title">Next Generation Server Compression With Brotli</h1>
          <div data-component="EditButton" data-collection="articles" data-path="articles/2016-10-05-next-generation-server-compression-with-brotli.md"></div>
         </header>
        </div>
        <div class="c-garfield-aside--meta">
         <ul class="meta-box meta-box--article">
          <li class="meta-box--item meta-box--published">18 min read</li>
          <li class="meta-box--item meta-box--tags"><a href="/category/coding">Coding</a>, <a href="/category/servers">Servers</a>, <a href="/category/performance">Performance</a>, <a href="/category/node.js">Node.js</a>, <a href="/category/https">HTTPS</a></li>
          <li class="meta-box--item meta-box--share">
           <section>
            Share on <a href="https://TwItTeR.CoM/intent/tweet?text=Next%20Generation%20Server%20Compression%20With%20Brotli&amp;url=https%3A%2F%2Fwww.smashingmagazine.com%2f2016%2f10%2fnext-generation-server-compression-with-brotli%2f&amp;via=smashingmag">Twitter</a> or&nbsp;<a href="https://cats.smashing.services/ball?uri=//www.linkedin.com/shareArticle?url=https://www.smashingmagazine.com%2f2016%2f10%2fnext-generation-server-compression-with-brotli%2f&amp;title=Next%20Generation%20Server%20Compression%20With%20Brotli">LinkedIn</a>
           </section></li>
         </ul>
        </div>
        <div class="c-garfield-aside--newsletter">
         <div class="c-promo-box c-promo-box--newsletter">
          <div class="promo-newsletter--article">
           <div class="promo-newsletter">
            <div class="promo-newsletter-image-wrapper">
             <a href="/the-smashing-newsletter/" class="promo-newsletter-image-link"><img src="https://d33wubrfki0l68.cloudfront.net/1dbc465f56f3a812f09666f522fa226efd947cfa/a4d9f/images/smashing-cat/newsletter-fish-cat.svg" width="224" height="290" loading="lazy" class="promo-newsletter-image" alt="A postcat. Sign up for our Smashing Newsletter."></a>
            </div>
            <h2 class="h2 promo-newsletter-title">Smashing Newsletter</h2>
            <p class="promo-newsletter-description">Upgrade your inbox and get our editors’ picks 2× a month — delivered right into your inbox. <a href="https://www.smashingmagazine.com/the-smashing-newsletter/">Earlier issues.</a></p>
            <div class="promo-newsletter-form-wrapper">
             <div class="nl__form-wrapper">
              <form method="post" action="//smashingmagazine.us1.list-manage.com/subscribe/post?u=16b832d9ad4b28edf261f34df&amp;id=a1666656e0" class="nl__form">
               <div class="input-wrapper">
                <label for="email" class="form__field js-form-field form__field--floating nl__form__content"><span class="form__field__label">Your <span class="form__field__label--extra">(smashing)</span> email</span> <input autocomplete="off" class="form__field__input" type="email" pattern="(.+)@(.+){2,}\.(.+){2,}" name="EMAIL" id="email" required></label> <button data-event-category="Button" data-event-action="click" data-event-label="Newsletter Box" type="submit" class="btn btn--medium  btn--green btn--promo-newsletter   ladda-button ladda-button--fixed" data-style="expand-right" onclick="this.form&amp;&amp;this.form.submit()" value="Submit"> <span class="ladda-label">Subscribe <span class="nl__form__arrow">→</span> <wbr></span><span class="ladda-spinner"></span></button>
               </div>
              </form>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="c-garfield-native-panel">
         <div class="c-promo-box c-promo-box--ad sponsors sponsors__native" data-audience="non-subscriber" data-remove="true" data-rendered="true">
          <ul class="bnnr-list"></ul>
         </div>
        </div>
        <div class="c-garfield-native-panel c-garfield-native-panel__below">
         <div class="c-promo-box c-promo-box--ad sponsors sponsors__native" data-audience="non-subscriber" data-remove="true" data-rendered="true">
          <ul class="bnnr-list"></ul>
         </div>
        </div>
        <div class="c-garfield-summary">
         <section aria-label="quick summary" class="article__summary">
          Chances are pretty good that you’ve worked with, or at least understand the concept of, server compression. By compressing website assets on the server prior to transferring them to the browser, we’ve been able to achieve substantial performance gains. For quite some time, the venerable gzip algorithm has been the go-to solution for reducing the size of page assets. A new kid on the block has been gaining support in modern browsers, and its name is Brotli. In this article, you’ll get hands-on with Brotli by writing a Node.js-powered HTTP server that implements this new algorithm, and we’ll compare its performance to gzip.
         </section>
        </div>
        <div class="drop-caps" aria-hidden="true">
         <img src="https://d33wubrfki0l68.cloudfront.net/ec871b89e0df48999b7266ce35768399760b5cef/83ef8/images/drop-caps/c.svg" alt> 
         <img src="https://d33wubrfki0l68.cloudfront.net/f27253afa5fd8465fac5d2cab0c1686450acbdd6/522b6/images/drop-caps/character-10.svg" alt>
        </div>
        <p>Chances are pretty good that you’ve worked with, or at least understand the concept of, server compression. By compressing website assets on the server prior to transferring them to the browser, we’ve been able to achieve substantial performance gains.</p>
        <p></p>
        <figure>
         <img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/00447d0b-18d9-446d-9907-5e4f47d65c68/network-utility-500.png" width="500" height="58" alt="brotli" title="Next Generation Server Compression With Brotli">
        </figure>
        <p>For quite some time, the venerable gzip algorithm has been the go-to solution for reducing the size of page assets. A new kid on the block has been gaining support in modern browsers, and its name is Brotli. In this article, you’ll get hands-on with Brotli by writing a Node.js-powered HTTP server that implements this new algorithm, and we’ll compare its performance to gzip.</p>
        <p></p>
        <h3 id="span-class-rh-further-reading-span-on-smashingmag"><span class="rh">Further Reading</span> on SmashingMag:</h3>
        <ul>
         <li><a href="https://www.smashingmagazine.com/2016/12/front-end-performance-checklist-2017-pdf-pages/">Front-End Performance Checklist 2017</a></li>
         <li><a href="https://www.smashingmagazine.com/2014/09/improving-smashing-magazine-performance-case-study/">Improving Smashing Magazine’s Performance: A Case Study</a></li>
         <li><a href="https://www.smashingmagazine.com/2013/12/imageoptim-cli-batch-compression-tool/">Meet ImageOptim-CLI, A Batch Compression Tool</a></li>
         <li><a href="https://www.smashingmagazine.com/2015/06/efficient-image-resizing-with-imagemagick/">Efficient Image Resizing With ImageMagick</a></li>
        </ul>
        <div data-component="FeaturePanel" data-audience="non-subscriber" data-remove="true" class="feature-panel-container hidden"></div>
        <h3 id="introducing-brotli">Introducing Brotli</h3>
        <p>Brotli is a compression algorithm maintained by Google and first released in 2015. Its namesake is a <a href="https://en.wikipedia.org/wiki/Spanisch_Br%C3%B6tli">Swiss pastry product</a>. It was not initially released for use as a standalone algorithm (as gzip was), but rather as an offline compression solution for the <a href="https://en.wikipedia.org/wiki/Web_Open_Font_Format">WOFF2 font format</a>. This means that if you’ve been using WOFF2 fonts, you’ve already been using Brotli and you didn’t even know it!</p>
        <p>Later in 2015, Brotli went beyond providing offline compression of WOFF2 fonts. Brotli is now supported in a large segment of browsers as a new <code>Accept-Encoding</code> scheme that we can use to compress page assets like we’ve been doing with gzip, but with a reported improvement in compression ratios. This is an enticing prospect for the performance-minded developer.</p>
        <p></p>
        <h4 id="hold-up-what-s-the-browser-support">Hold Up! What’s the Browser Support?</h4>
        <p>Browser support for Brotli is not universal. The following browsers support Brotli out of the box, without requiring you to turn on support for them under the hood:</p>
        <ul>
         <li>Chrome since version 50,</li>
         <li>Android Browser version 50,</li>
         <li>Chrome for Android since version 50,</li>
         <li>Firefox since version 44,</li>
         <li>Firefox for Android since version 46,</li>
         <li>Opera since version 38.</li>
        </ul>
        <p>While this list implies that Edge, Safari and others have left Brotli support out in the cold (for now, at least), caniuse.com indicates that its support is estimated at around 53% at the time of writing. Of course, this statistic will fluctuate over time, so <a href="http://caniuse.com/#search=brotli">see for yourself</a> what the support status is for this technology.</p>
        <p>Either way, we’re not talking about a small segment of users who would potentially benefit from the increased performance that this new algorithm provides, so it’s worth investigating to see what the gains are. Before jumping in with both feet, however, we should talk about the requirement that browsers have for this feature — namely, HTTPS.</p>
        <p></p>
        <h4 id="we-meet-again-https">We Meet Again, HTTPS</h4>
        <p>It’s hardly news that browser vendors have been advocating for the transition to a more secure web, and for good reason: HTTPS is no longer the burden it once was in terms of cost and performance. In fact, thanks to modern hardware and the HTTP/2 protocol’s multiplexing of requests over a single connection, the overhead of HTTPS connections is <a href="https://istlsfastyet.com/#faq">less than you might think</a>.</p>
        <p>In terms of cost, SSL certificates are downright cheap, at as little as $5 a year, depending on the reputation of the signing authority. If that cost is still a barrier for you, you can rely on <a href="https://letsencrypt.org/">Let’s Encrypt</a> for free SSL certificates. The barrier to entry for regular folks who need a secure website couldn’t be much flimsier than it is today, and that’s how it should be.</p>
        <p>As an additional motivator, browser vendors have been making SSL a <em>de facto</em> requirement for all sorts of new features, such as <a href="https://jakearchibald.com/2014/using-serviceworker-today/">Service Workers</a>, <a href="https://github.com/http2/http2-spec">HTTP/2</a> and, yes, even Brotli. We can see this requirement in action by visiting any secure website and examining any asset’s <code>Accept-Encoding</code> request header for the <code>br</code> token in a Brotli-enabled browser:</p>
        <figure>
         <a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/ad4818ac-5bb3-4962-af5b-82bd9dcbc366/accept-encoding-br.png"><img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/ad4818ac-5bb3-4962-af5b-82bd9dcbc366/accept-encoding-br.png" alt="The br token in the Accept-Encoding request header as seen in Google Chrome" width="500" height="23"></a>
         <figcaption>
          The <code>br</code> token in the <code>Accept-Encoding</code> request header, as seen in Google Chrome
         </figcaption>
        </figure>
        <p>If you go to a non-secure website over HTTP and look at the value of the same request header for any asset, you’ll see that the <code>br</code> token is absent.</p>
        <p>I’m sure by now you’ve had enough of the hype and are ready to get your hands dirty with Brotli. So, let’s get started by writing a small web server in Node.js using the Express framework, and implement Brotli using the <code>shrink-ray</code> package.</p>
        <p></p>
        <h3 id="building-a-brotli-enabled-web-server-in-node-js">Building A Brotli-Enabled Web Server In Node.js</h3>
        <p>Adding Brotli to existing web servers such as Nginx or Apache can prove to be inconvenient, depending on your familiarity with them. A Brotli module <a href="https://github.com/google/ngx_brotli">does exist for Nginx</a>, as does <a href="https://github.com/kjdev/apache-mod-brotli">one for Apache</a>, but building and running the Apache module requires some know-how. That’s fine if you’re cool with that sort of thing, but most of us just want to install something and get right to the tinkering!</p>
        <p>So, to make things a little easier on ourselves, I’ll be showing you how to set up a small Brotli-capable server written in JavaScript using <a href="https://nodejs.org">Node.js</a> and <a href="https://expressjs.com">Express</a>. Even if you’ve never used these technologies, don’t worry. All you’ll need before you begin is to have a copy of Node.js installed; you’ll be guided through the entire process. Before you know it, you’ll have a Brotli-powered web server up and running on your local machine, ready for your scrutiny.</p>
        <p></p>
        <h4 id="installing-the-prerequisites">Installing the Prerequisites</h4>
        <p>Because our testing server is in HTTPS, we’ll need to have a certificate and key handy. Generating these can be a chore. To make things easier, you can clone the certificates and directory structure we need by using <code>git</code>:</p>
        <pre>   <code class="language-bash">
git clone <a href="https://github.com/malchata/brotli-server.git">https://github.com/malchata/brotli-server.git</a>
    </code>
</pre>
        <p></p>
        <p>This will download a GitHub repository with our certificate and key files in the <code>crt</code> directory, and an empty web root directory of <code>htdocs</code>. You can enter into the repository directory by typing <code>cd brotli-server</code>.</p>
        <p>(Want to skip ahead? If you’re not terribly interested in writing the web server code from scratch and want to get right to messing with Brotli, you can skip ahead by switching to a branch with the completed code by typing <code>git checkout -f brotli-server</code>.)</p>
        <p>In order for the server to work, we’ll need to install a few packages using <a href="https://npmjs.com">npm</a>:</p>
        <pre>   <code class="language-bash">
npm install express https shrink-ray
    </code>
</pre>
        <p></p>
        <p>This will install three packages:</p>
        <ul>
         <li><code>express</code> is the Express framework package. This is used to spin up a simple static web server that will serve content from the <code>htdocs</code> directory.</li>
         <li><code>https</code> is the package that enables us to serve files over HTTPS.</li>
         <li><code>shrink-ray</code> is the compression middleware that contains the Brotli functionality we want to test. It includes gzip functionality as well. <em><strong>Note:</strong> If you’re doing all of this on Windows, this package relies on node-gyp, which can be problematic for Windows users. You’ll have better luck if you have a Linux subsystem, such as the one available on Windows 10. Chances are that if you’re developing for Node on Windows, you’re aware of the idiosyncrasies. If not, <a href="https://github.com/nodejs/node-gyp/issues/629#issuecomment-225578519">read this comment</a> in a Github gist regarding the subject.</em></li>
        </ul>
        <p>Installing these dependencies might take a minute. Once it’s finished, you’ll be ready to write your web server code!</p>
        <h4 id="writing-the-web-server-code">Writing the Web Server Code</h4>
        <p>In your text editor of choice, create a new JavaScript file named <code>https.js</code>, and begin with the following code:</p>
        <pre>   <code class="language-javascript">
var express = require(“express”), // Imports the express package
    https = require(“https”), // Imports the https package
    shrinkRay = require(“shrink-ray”), // Imports the compression middleware
    fs = require(“fs”), // The file system module for reading files (part of Node.js core)
    path = require(“path”), // The path module for working with files and directory paths (also part of Node.js core)
    app = express(), // An Express instance
    pubDir = “./htdocs”; // The web root directory
    </code>
</pre>
        <p></p>
        <p>In case you’re somewhat new to Node.js, the <code>require</code> method imports the modules we need for use in the current script. The <code>pubDir</code> variable is what we’ll use to refer to the <code>htdocs</code> directory, which is where we’ll serve files from.</p>
        <p>Continuing on, we’ll need to set up our compression middleware from the <code>shrink-ray</code> package by telling our Express instance in the <code>app</code> object to use it. We’ll also instruct our Express instance to statically serve files from the <code>htdocs</code> directory:</p>
        <pre>   <code class="language-javascript">
app.use(shrinkRay()); // Tell Express to use the shrink-ray compression middleware
app.use(express.static(path.join(__dirname, pubDir))); // Tell Express to serve static files from the htdocs directory
    </code>
</pre>
        <p></p>
        <p>We’ll top it all off by setting up our HTTPS server and running it on port 8443:</p>
        <pre>   <code class="language-javascript">
https.createServer({ // Creates an instance of an HTTPS sever
    key: fs.readFileSync(“crt/localhost.key”), // Reads in the key file
    cert: fs.readFileSync(“crt/localhost.crt”) // Reads in the SSL certificate
}, app).listen(8443); // Passes in our Express instance and instructs the server to run on port 8443
    </code>
</pre>
        <p></p>
        <p>Now for the moment of truth, when we run our Brotli-powered web server:</p>
        <pre>   <code class="language-bash">
node https.js
    </code>
</pre>
        <p></p>
        <p>If all has gone well, no errors should occur and the server will start. To test it out, point your browser to <a href="https://localhost:8443/readme.txt">https://localhost:8443/readme.txt</a>, and you should see a short message. If you’ve gotten to this point, you’re ready to verify that Brotli is working.</p>
        <p></p>
        <h4 id="how-can-you-tell-that-brotli-is-working">How Can You Tell That Brotli Is Working?</h4>
        <p>By default, <code>shrink-ray</code> will compress content with Brotli if the requesting browser supports it and if the server is running on HTTPS. The easiest way to check for support is to grab a copy of a JavaScript library (<a href="https://fb.me/react-15.1.0.min.js">such as React</a>) and save it in the <code>htdocs</code> directory.</p>
        <p>From here, open Chrome or Firefox and launch the developer tools. You can do this by pressing <code>F12</code> on a Windows machine or <code>Command + Alt + I</code> on a Mac. Once the tools are open, click on the “Network” tab. The “Network” tab is a common utility available in Chrome and Firefox’s developer tools that shows all of the network requests for a given web page. With this tab open, navigate to the asset you saved in the <code>htdocs</code> folder on the local web server. You’ll see the network utility populate with the requested resource.</p>
        <p>In Chrome, we can see the value of an asset’s <code>Content-Encoding</code> header in the network utility’s “Content-Encoding” column. If this column is not visible, just right-click on the column headers and choose it from the menu that appears. If Brotli is working, you should see a <code>br</code> token in the “Content-Encoding” column similar to what’s shown in the image below:</p>
        <figure>
         <a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/0c1ad14e-1940-4350-87ff-7e2cf7154611/network-utility.png"><img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/00447d0b-18d9-446d-9907-5e4f47d65c68/network-utility-500.png" alt="The br token present in the Content-Encoding request header, as seen in Google Chrome" width="500" height="58"></a>
         <figcaption>
          The <code>br</code> token in the <code>Accept-Encoding</code> response header, as seen in Chrome's network utility (<a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/0c1ad14e-1940-4350-87ff-7e2cf7154611/network-utility.png">View large version</a>)
         </figcaption>
        </figure>
        <p>Now that we’ve verified that Brotli is running on our local test web server, let’s see how Brotli performs compared to gzip!</p>
        <h3 id="evaluating-brotli-s-performance">Evaluating Brotli’s Performance</h3>
        <p>Now to the meat of the matter: How well does Brotli perform compared to gzip? If you don’t want to do a ton of testing, there’s a <a href="https://github.com/crdumoul/brotli-perf-test">performance test</a> that gives a good overview of Brotli’s performance. The test is set up to download assets from popular websites specified in a text file, and once the assets are gathered, the test process commences, as specified in the GitHub repository’s <code>README</code> document:</p>
        <ol>
         <li>Read the file’s contents into memory.</li>
         <li>Take a timestamp to mark the start of the test.</li>
         <li>Compress the file 100 times using Brotli level 1.</li>
         <li>Take a timestamp to mark the end of the test.</li>
         <li>Record the compressed file size and compression speed (in MB per second).</li>
         <li>Repeat steps 2 to 5 for Brotli levels 2 to 11.</li>
         <li>Repeat steps 2 to 5 for Gzip level 6.</li>
         <li>Output the results in JSON format.</li>
        </ol>
        <p>The number of websites specified in the benchmark’s text file is huge, and thus the test takes a very long time to complete. In the interest of time, I specified 20 websites that I frequent (including this website) and ran the benchmark over them instead. I felt that this would still provide a good high-level view of Brotli’s performance on all compression levels compared to the default gzip setting of <code>6</code>. The average compression speeds of all Brotli settings versus the default gzip setting are shown in the table below:</p>
        <br>
        <table class="article-table three-columns">
         <tbody>
          <tr>
           <th>Algorithm</th>
           <th>Compression level</th>
           <th>Speed (MB per second)</th>
          </tr>
          <tr>
           <td>gzip</td>
           <td>6</td>
           <td>11.8</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>1</td>
           <td>41.5</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>2</td>
           <td>16</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>3</td>
           <td>13.6</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>4</td>
           <td>6.83</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>5</td>
           <td>5.98</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>6</td>
           <td>5.8</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>7</td>
           <td>0.966</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>8</td>
           <td>0.758</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>9</td>
           <td>0.555</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>10</td>
           <td>0.119</td>
          </tr>
          <tr>
           <td>Brotli</td>
           <td>11</td>
           <td>0.121</td>
          </tr>
         </tbody>
        </table>
        <p></p>
        <p>As said, this is a very high-level overview. The test collects a lot of data, but average compression speed gives us a basic idea of how Brotli compares to gzip’s default compression level. The one flaw of this test is that it doesn’t collect data for <em>all</em> gzip settings from <code>1</code> to <code>9</code>. It also can’t really quantify how Brotli influences website loading times, because the test measures compression performance on files already on the disk. Despite this, this overview is somewhat indicative of what you’ll see in the following tests, in that higher compression settings are going to be the slowest. We just need to see how this influences website loading times and how it compares to all available gzip settings.</p>
        <p>To fill in the blanks a bit, I’ve done some of my own performance testing. First, we’ll look at how well <em>all</em> Brotli compression settings compare to <em>all</em> gzip settings for a single asset. Then, we’ll do the same for a Node.js-driven website running on a local machine that is bandwidth-throttled using Chrome’s network-throttling utility. Then, we’ll do the same again, but for an Apache-driven website using the <code>mod_brotli</code> compression module.</p>
        <p></p>
        <h4 id="testing-methods">Testing Methods</h4>
        <p>When testing, I wanted to pick a JavaScript library that is popular and also very large. React fits the bill perfectly, coming in at 144 kilobytes minified. This seems like a reasonable test subject for comparing compression algorithm performance for a single file.</p>
        <p>When comparing compression algorithms, we also want to know more than what the final size of a compressed asset is. While this dimension is strongly tied to page-loading time, it’s important to note that it’s not a consistent relationship in every scenario. Compressing content eats up CPU time, and if an algorithm is too CPU-intensive, there’s a chance that any gains made in compression ratios will be nullified if the algorithm takes too long to do its job. Therefore, we want to know two dimensions: the final file size and the amount of time it takes for the compressed asset to load.</p>
        <p>However, simply comparing gzip and Brotli out of the box isn’t enough. We can adjust the settings for both of these technologies, and when we do so, we influence their performance. gzip allows us to specify a compression level between <code>0</code> and <code>9</code>, with <code>0</code> turning off compression altogether. Brotli can similarly be set between <code>1</code> and <code>11</code>. gzip’s default is <code>6</code>, and the default that the <code>shrink-ray</code> package sets for Brotli is <code>4</code>. We can set Brotli’s compression level like so:</p>
        <pre>   <code class="language-javascript">
app.use(shrinkRay({
    brotli: {
        quality: 11 // Compression level configurable from 1 to 11
    }
}));
    </code>
</pre>
        <p></p>
        <p>In the table below is a comprehensive collection of final file sizes when compressing the selected JavaScript library on all configurable levels for both Brotli and gzip. Numbers are in kilobytes, and the lowest file sizes are underlined and bolded.</p>
        <br>
        <table class="article-table four-columns">
         <tbody>
          <tr>
           <th>Level</th>
           <th>gzip (KB)</th>
           <th>Brotli (KB)</th>
          </tr>
          <tr>
           <td>1</td>
           <td>50.4</td>
           <td><u><strong>48.6</strong></u></td>
          </tr>
          <tr>
           <td>2</td>
           <td>48.6</td>
           <td><u><strong>44.8</strong></u></td>
          </tr>
          <tr>
           <td>3</td>
           <td>47.4</td>
           <td><u><strong>44.1</strong></u></td>
          </tr>
          <tr>
           <td>4</td>
           <td>44.5</td>
           <td><u><strong>42.9</strong></u></td>
          </tr>
          <tr>
           <td>5</td>
           <td>43.2</td>
           <td><u><strong>40.2</strong></u></td>
          </tr>
          <tr>
           <td>6</td>
           <td>42.8</td>
           <td><u><strong>39.8</strong></u></td>
          </tr>
          <tr>
           <td>7</td>
           <td>42.7</td>
           <td><u><strong>39.5</strong></u></td>
          </tr>
          <tr>
           <td>8</td>
           <td>42.6</td>
           <td><u><strong>39.4</strong></u></td>
          </tr>
          <tr>
           <td>9</td>
           <td>42.6</td>
           <td><u><strong>39.3</strong></u></td>
          </tr>
          <tr>
           <td>10</td>
           <td><em>n/a</em></td>
           <td>36.8</td>
          </tr>
          <tr>
           <td>11</td>
           <td><em>n/a</em></td>
           <td>36.2</td>
          </tr>
         </tbody>
        </table>
        <p></p>
        <p>At a glance, we can see that the gains are quite impressive. At the highest compression level, Brotli outdoes gzip by 6.4 kilobytes, which is no small amount of data. As stated earlier, though, trade-offs can occur when compression levels are sufficiently high. Let’s see how loading times are affected across the various compression levels:</p>
        <br>
        <table class="article-table three-columns">
         <tbody>
          <tr>
           <th>Level</th>
           <th>gzip (milliseconds)</th>
           <th>Brotli (milliseconds)</th>
          </tr>
          <tr>
           <td>1</td>
           <td>640.6</td>
           <td><u><strong>623.8</strong></u></td>
          </tr>
          <tr>
           <td>2</td>
           <td>626</td>
           <td><u><strong>577.8</strong></u></td>
          </tr>
          <tr>
           <td>3</td>
           <td>610.2</td>
           <td><u><strong>578.2</strong></u></td>
          </tr>
          <tr>
           <td>4</td>
           <td>578</td>
           <td><u><strong>563.2</strong></u></td>
          </tr>
          <tr>
           <td>5</td>
           <td>568</td>
           <td><u><strong>534.8</strong></u></td>
          </tr>
          <tr>
           <td>6</td>
           <td>564.6</td>
           <td><u><strong>532</strong></u></td>
          </tr>
          <tr>
           <td>7</td>
           <td>569.2</td>
           <td><u><strong>514.4</strong></u></td>
          </tr>
          <tr>
           <td>8</td>
           <td>567.4</td>
           <td><u><strong>514</strong></u></td>
          </tr>
          <tr>
           <td>9</td>
           <td>563</td>
           <td><u><strong>517.2</strong></u></td>
          </tr>
          <tr>
           <td>10</td>
           <td><em>n/a</em></td>
           <td>558.8</td>
          </tr>
          <tr>
           <td>11</td>
           <td><em>n/a</em></td>
           <td>704.6</td>
          </tr>
         </tbody>
        </table>
        <p></p>
        <p>Because the test server runs locally, I ran the test in Chrome using the “Regular 3G” profile in the network-throttling utility, to simulate what loading times would be like over a slow mobile connection. Each figure is the average of five test runs.</p>
        <p>In instances where direct comparisons can be made, Brotli seems to perform better in both file-size yield and loading time. Once we hit compression levels <code>10</code> and <code>11</code>, however, we started to see hugely diminishing returns. Even though these compression levels yield much smaller file sizes, the computational overhead erases the gains made in file size.</p>
        <p>The <code>shrink-ray</code> package makes up for this overhead in its own way with a caching mechanism. In these tests, that caching mechanism was disabled to get an accurate picture of Brotli’s performance with on-the-fly compression. The default behavior of <code>shrink-ray</code> is to first compress the response at the default quality setting. While that happens, the same asset is asynchronously compressed at the highest-quality setting and then cached for subsequent requests.</p>
        <p>This caching mechanism yields a loading time of around 480 milliseconds for the React library. Note that this caching feature does not come standard with Brotli, but is rather how <code>shrink-ray</code> is designed to work. Any module that implements Brotli may or may not cache entries for recently compressed assets.</p>
        <p></p>
        <h4 id="performance-in-a-real-scenario">Performance in a Real Scenario</h4>
        <p>All of this seems rather clinical, because we’re not actually applying this to a real website, but rather to a single file. To get an idea of real-world performance, I took a <a href="http://coyleappliancerepair.com">client’s website</a> and ran it through the wringer on my local computer. I tested loading times over the varying quality levels for Brotli with caching disabled, and then with compression caching enabled to see how the <code>shrink-ray</code> package performs when left to its own devices. Below are comparisons of loading times using the same methodology outlined earlier:</p>
        <br>
        <table class="article-table three-columns">
         <tbody>
          <tr>
           <th>Level</th>
           <th>gzip (milliseconds)</th>
           <th>Brotli (milliseconds)</th>
          </tr>
          <tr>
           <td>1</td>
           <td>871.4</td>
           <td><u><strong>869.2</strong></u></td>
          </tr>
          <tr>
           <td>2</td>
           <td>869.2</td>
           <td><u><strong>848.4</strong></u></td>
          </tr>
          <tr>
           <td>3</td>
           <td>868</td>
           <td><u><strong>858.4</strong></u></td>
          </tr>
          <tr>
           <td>4</td>
           <td><u><strong>845</strong></u></td>
           <td>850.2</td>
          </tr>
          <tr>
           <td>5</td>
           <td><u><strong>850.8</strong></u></td>
           <td>857.8</td>
          </tr>
          <tr>
           <td>6</td>
           <td>852.8</td>
           <td><u><strong>844.8</strong></u></td>
          </tr>
          <tr>
           <td>7</td>
           <td>867.8</td>
           <td><u><strong>846.4</strong></u></td>
          </tr>
          <tr>
           <td>8</td>
           <td>860.4</td>
           <td><u><strong>833.8</strong></u></td>
          </tr>
          <tr>
           <td>9</td>
           <td>847.8</td>
           <td><u><strong>832.6</strong></u></td>
          </tr>
          <tr>
           <td>10</td>
           <td><em>n/a</em></td>
           <td>825.2</td>
          </tr>
          <tr>
           <td>11</td>
           <td><em>n/a</em></td>
           <td>849</td>
          </tr>
          <tr>
           <td>11 (Cached)</td>
           <td><em>n/a</em></td>
           <td>823.2</td>
          </tr>
         </tbody>
        </table>
        <p></p>
        <p>In this case, we’re able to take a website that would otherwise be 52.4 KB at the highest gzip setting of <code>9</code>, and reduce its payload to 48.4 KB with Brotli’s highest setting of <code>11</code>. This is a reduction of about 8%, and after the caching takes effect, we can reduce loading times further. Bear in mind that this example is of a small website. Your mileage may vary. That’s not to say that there won’t be a benefit for websites with larger payloads, only that you should perform your own analysis before fully implementing Brotli for your website.</p>
        <p>Another scenario we can look at is a WordPress blog that runs on an Apache server. <a href="http://legendarytones.com">Legendary Tones</a> is a website that I host for a friend. Although the <a href="https://github.com/kjdev/apache-mod-brotli"><code>mod_brotli</code></a> module for Apache is in its nascent stage, it works well enough that we can test with it. I pulled down the website and ran it on my local Apache server, and I tested all available settings for both <code>mod_deflate</code> and <code>mod_brotli</code>. The conditions for this test are the same as before: Throttle the bandwidth using Chrome’s throttling utility at the “Regular 3G” setting, but instead of 5 trials, I performed 20.</p>
        <br>
        <table class="article-table four-columns">
         <tbody>
          <tr>
           <th>Level</th>
           <th>gzip (milliseconds)</th>
           <th>Brotli (milliseconds)</th>
          </tr>
          <tr>
           <td>1</td>
           <td><u><strong>3060</strong></u></td>
           <td>3064</td>
          </tr>
          <tr>
           <td>2</td>
           <td><u><strong>2968</strong></u></td>
           <td>2980</td>
          </tr>
          <tr>
           <td>3</td>
           <td>3004</td>
           <td><u><strong>2914</strong></u></td>
          </tr>
          <tr>
           <td>4</td>
           <td>2900</td>
           <td><u><strong>2894</strong></u></td>
          </tr>
          <tr>
           <td>5</td>
           <td>2910</td>
           <td><u><strong>2772</strong></u></td>
          </tr>
          <tr>
           <td>6</td>
           <td>2858</td>
           <td><u><strong>2758</strong></u></td>
          </tr>
          <tr>
           <td>7</td>
           <td>2836</td>
           <td><u><strong>2806</strong></u></td>
          </tr>
          <tr>
           <td>8</td>
           <td><u><strong>2854</strong></u></td>
           <td>2896</td>
          </tr>
          <tr>
           <td>9</td>
           <td>2998</td>
           <td><u><strong>2990</strong></u></td>
          </tr>
          <tr>
           <td>10</td>
           <td><em>n/a</em></td>
           <td>2910</td>
          </tr>
          <tr>
           <td>11</td>
           <td><em>n/a</em></td>
           <td>2766</td>
          </tr>
         </tbody>
        </table>
        <p></p>
        <p>In most scenarios where direct comparisons can be made, Brotli seems to outperform gzip, even if only by a little bit. However, let’s examine a few caveats for all of the tests we’ve done:</p>
        <ul>
         <li>These tests were done on a local web server whose only traffic was me.</li>
         <li>While Brotli yields significantly lower file sizes at the highest compression levels, the loading times of these assets <em>usually</em> tend to suffer at the <code>10</code> and <code>11</code> quality settings.</li>
         <li>If we can cache the compressed response ahead of time, we can negate the long processing time of higher Brotli compression levels. <code>shrink-ray</code> does this for us automatically, but other implementations might lack this caching mechanism.</li>
        </ul>
        <p>If you’re willing to test Brotli for your projects, you’ll get a better idea of whether it’s a good fit. The good news is that if you set up your web server properly, browsers that don’t support Brotli will just fall back to gzip, meaning that everyone will get <em>some</em> benefit, regardless of what algorithms are supported. For example, here’s a line from <a href="https://jeremywagner.me">my website</a>’s Apache configuration that implements both <code>mod_brotli</code> and <code>mod_deflate</code>:</p>
        <pre>   <code>
AddOutputFilterByType BROTLI;DEFLATE text/html text/css application/javascript text/javascript image/svg+xml text/plain text/xml application/x-javascript
    </code>
</pre>
        <p></p>
        <p>The key piece of this configuration directive is the <code>BROTLI;DEFLATE</code> portion. When both the <code>mod_brotli</code> and <code>mod_deflate</code> modules are loaded, we can specify what compression algorithm is preferred. By placing <code>BROTLI</code> first in the chain, browsers that support it will receive content compressed by it. In the event that a browser comes along that doesn’t support Brotli, it will be served by gzip (<code>DEFLATE</code>) instead.</p>
        <p>With our time together coming to an end, let’s take a minute to cover a bit of what we’ve learned about Brotli.</p>
        <p></p>
        <h3 id="conclusion">Conclusion</h3>
        <p>My findings at this time tell me that you have every good reason to do some research and see what’s possible with Brotli on your website. In most situations, it seems that Brotli can squeeze a bit more performance out of your websites, which might be worth pursuing.</p>
        <p>While Brotli really starts to get sluggish at higher compression levels, striking a good balance can provide some level of benefit. I can’t possibly give any sweeping generalizations as to what compression settings are good for all websites. You’ll just need to test on your own. I highly recommend using this approach to see what the results are for you and to see what implementations exist for your server. If you’re serving pages with Node.js, Nginx or Apache, you’ve got options.</p>
        <p>Furthermore, it’s worth noting that Brotli is a continually evolving project. <a href="https://github.com/google/brotli">Google’s GitHub repository</a> of the project shows that contributions are made regularly, and that’s reason enough for the performance-minded web developer to keep an eye on this promising new technology.</p>
        <p></p>
        <p><em>This article is about a relatively new alternative to gzip compression, named Brotli. This and many other topics are covered in Jeremy’s book </em>Web Performance in Action<em>, which you can get from <a href="http://manning.com">Manning Publications</a> for 38% off with the coupon code <code>smashmagpc</code>, as well as any other Manning book!</em></p>
        <div class="signature">
         <img src="https://www.smashingmagazine.com/images/logo/logo--red.png" alt="Smashing Editorial"> <span>(rb, al, il)</span>
        </div>
       </div>
      </div>
     </div>
     <div class="c-promo-box sponsors sponsors__lead hidden sponsors__external" data-audience="non-subscriber" data-remove="true" data-amount="1"></div>
     <div class="c-promo-box sponsors sponsors__lead hidden sponsors__external" data-audience="non-subscriber" data-remove="true" data-amount="1"></div>
     <div id="sponsors-article-end" data-impression="true" class="c-promo-box c-promo-box--ad c-promo-box--wide sponsors sponsors__row hidden sponsors__external" data-audience="non-subscriber" data-remove="true"></div>
     <div data-component="CommentsArea" id="comments-next-generation-server-compression-with-brotli" data-thread="/2016/10/next-generation-server-compression-with-brotli/" data-date="2016-10-05 18:58:31 +0000 UTC"></div>
    </div>
   </article>
  </main>
  <footer class="main-footer">
   <div class="container">
    <div class="col-12">
     <div class="footer__topics open">
      <h4 class="footer__topics__title" id="topics">Browse All Smashing Magazine Topics</h4>
      <ul class="footer__topics__list">
       <li class="footer__topics__item"><a href="/category/accessibility">Accessibility</a></li>
       <li class="footer__topics__item"><a href="/category/android">Android</a></li>
       <li class="footer__topics__item"><a href="/category/animation">Animation</a></li>
       <li class="footer__topics__item"><a href="/category/apps">Apps</a></li>
       <li class="footer__topics__item"><a href="/category/css">CSS</a></li>
       <li class="footer__topics__item"><a href="/category/design">Design</a></li>
       <li class="footer__topics__item"><a href="/category/design-patterns">Design Patterns</a></li>
       <li class="footer__topics__item"><a href="/category/design-systems">Design Systems</a></li>
       <li class="footer__topics__item"><a href="/category/e-commerce">E-Commerce</a></li>
       <li class="footer__topics__item"><a href="/category/freebies">Freebies</a></li>
       <li class="footer__topics__item"><a href="/category/graphics">Graphics</a></li>
       <li class="footer__topics__item"><a href="/category/html">HTML</a></li>
       <li class="footer__topics__item"><a href="/category/illustrator">Illustrator</a></li>
       <li class="footer__topics__item"><a href="/category/inspiration">Inspiration</a></li>
       <li class="footer__topics__item"><a href="/category/ios">iOS</a></li>
       <li class="footer__topics__item"><a href="/category/javascript">JavaScript</a></li>
       <li class="footer__topics__item"><a href="/category/mobile">Mobile</a></li>
       <li class="footer__topics__item"><a href="/category/pattern-libraries">Pattern Libraries</a></li>
       <li class="footer__topics__item"><a href="/category/performance">Performance</a></li>
       <li class="footer__topics__item"><a href="/category/photoshop">Photoshop</a></li>
       <li class="footer__topics__item"><a href="/category/plugins">Plugins</a></li>
       <li class="footer__topics__item"><a href="/category/react">React</a></li>
       <li class="footer__topics__item"><a href="/category/responsive-web-design">Responsive Web Design</a></li>
       <li class="footer__topics__item"><a href="/category/service-workers">Service Workers</a></li>
       <li class="footer__topics__item"><a href="/category/sketch">Sketch</a></li>
       <li class="footer__topics__item"><a href="/category/typography">Typography</a></li>
       <li class="footer__topics__item"><a href="/category/ui">UI</a></li>
       <li class="footer__topics__item"><a href="/category/usability">Usability</a></li>
       <li class="footer__topics__item"><a href="/category/user-experience">User Experience</a></li>
       <li class="footer__topics__item"><a href="/category/wallpapers">Wallpapers</a></li>
       <li class="footer__topics__item"><a href="/category/web-design">Web Design</a></li>
       <li class="footer__topics__item"><a href="/category/wordpress">WordPress</a></li>
       <li class="footer__topics__item"><a href="/category/workflow">Workflow</a></li>
      </ul>
     </div>
    </div>
    <div class="col-12">
     <div class="footer__notes">
      <p>With a commitment to quality content for the design community.</p>
      <p>Founded by Vitaly Friedman and Sven Lennartz. <span class="lining-figures">2006–2020</span>.</p>
      <p>Smashing is proudly running on <a href="https://www.netlify.com/?utm_source=link&amp;utm_medium=parter&amp;utm_campaign=sm-footer">Netlify</a>.</p>
      <p>Fonts by <a href="http://latinotype.com/">Latinotype</a>.</p>
     </div>
     <ul class="footer__links">
      <li>✎ <a href="/write-for-us/">Write for us</a></li>
      <li><a href="/contact/">Contact us</a></li>
      <li><a href="/about/">About us (Impressum)</a></li>
      <li><a href="/privacy-policy">Privacy policy</a></li>
      <li><a href="/auth/">Membership login</a></li>
      <li><a href="/delivery-times/">Delivery times</a></li>
      <li><a href="mailto:advertising@smashingmagazine.com?subject=Let’s talk about advertising">Advertise</a></li>
     </ul>
    </div>
   </div>
   <div class="back-to-top-wrapper" id="back_top">
    <a href="#top" data-scroll="#top" class="back-to-top" title="Back to top">
     <svg viewbox="0 0 100 100" width="25" height="25" tabindex="-1" role="img" aria-labelledby="title">
      <title id="title">Back to top</title><path d="M10 50l50 50L70 90 30 50 70 10 60 0z" transform="translate(0 0) rotate(90 50 50)" fill="#fff" stroke="#fff" /><image src="https://d33wubrfki0l68.cloudfront.net/a0a37998d83f76d320162750bc965f3ee67980be/820d5/images/back-to-top-arrow.png" alt="Back to top arrow" width="100%" height="100%" />
     </svg></a>
   </div>
   <div id="cart" class="cart-wrapper" data-component="MiniCart"></div>
  </footer>
  <div data-handler="PostLoad"></div>
  <script>window.PRERELEASES={}</script>
  <script defer src="https://d33wubrfki0l68.cloudfront.net/js/d7823d7870a3e8ccfb05b6e6a3b4a226104fe203/js/ga.js"></script>
  <script defer type="text/plain" data-cookieconsent="statistics" src="https://www.google-analytics.com/analytics.js"></script>
  <script defer src="https://d33wubrfki0l68.cloudfront.net/js/8ffa244a7992a11c2a32ae921602b572fe2e7e83/js/app.js"></script>
  <link rel="stylesheet" type="text/css" media="print" href="https://d33wubrfki0l68.cloudfront.net/css/2886fb6db82c27d95feb58031e86df7ee6bae8c8/css/print.css">
  <script>function CookiebotCallback_OnLoad(){Cookiebot&&Cookiebot.runScripts()}
function CookiebotCallback_OnAccept(){Cookiebot&&Cookiebot.runScripts()}</script>
  <script defer id="Cookiebot" src="https://consent.cookiebot.com/uc.js" importance="low" data-cbid="477cf258-f4e3-42e2-811d-73547904d716" type="text/javascript"></script>
  <script class="js-additional" defer src="https://d33wubrfki0l68.cloudfront.net/bundles/8f3b4e8fbec0795ac2a9ecdeceff4cea7b73ecd6.js"></script>
 </body>
</html>